# wherehouse ì„±ëŠ¥ ë¡œê·¸ ë¶„ì„ ìë™í™” ì‹œìŠ¤í…œ ì„¤ê³„ì„œ v2.1

**ì‘ì„±ì¼**: 2025-01-24  
**ì‘ì„±ì**: ì •ë²”ì§„  
**ë²„ì „**: 2.1 (Sheet 4: Raw_Data ì¶”ê°€)

---

## ğŸ“‹ ëª©ì°¨

1. [ê°œìš”](#1-ê°œìš”)
2. [ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜](#2-ì‹œìŠ¤í…œ-ì•„í‚¤í…ì²˜)
3. [ë””ë ‰í† ë¦¬ êµ¬ì¡°](#3-ë””ë ‰í† ë¦¬-êµ¬ì¡°)
4. [ê³µí†µ ë¼ì´ë¸ŒëŸ¬ë¦¬ (Common Layer)](#4-ê³µí†µ-ë¼ì´ë¸ŒëŸ¬ë¦¬-common-layer)
5. [ë°ì´í„° ì¶”ì¶œ ê³„ì¸µ (Extractor Layer)](#5-ë°ì´í„°-ì¶”ì¶œ-ê³„ì¸µ-extractor-layer)
6. [ë³´ê³ ì„œ ìƒì„± ê³„ì¸µ (Generator Layer)](#6-ë³´ê³ ì„œ-ìƒì„±-ê³„ì¸µ-generator-layer)
7. [Excel ë³´ê³ ì„œ êµ¬ì¡° (4-Sheet)](#7-excel-ë³´ê³ ì„œ-êµ¬ì¡°-4-sheet)
8. [ë‹¨ê³„ë³„ êµ¬í˜„ ëª…ì„¸](#8-ë‹¨ê³„ë³„-êµ¬í˜„-ëª…ì„¸)
9. [ì‹¤í–‰ ë°©ë²•](#9-ì‹¤í–‰-ë°©ë²•)
10. [íŠ¸ëŸ¬ë¸”ìŠˆíŒ…](#10-íŠ¸ëŸ¬ë¸”ìŠˆíŒ…)

---

## 1. ê°œìš”

### 1.1 ëª©ì 
wherehouse í”„ë¡œì íŠ¸ì˜ PERFORMANCE ë¡œê·¸ë¥¼ ìë™ ë¶„ì„í•˜ì—¬ ë³‘ëª© ì§€ì ì„ ì‹ë³„í•˜ê³ , Excel ë³´ê³ ì„œë¥¼ ìƒì„±í•˜ëŠ” ì‹œìŠ¤í…œì…ë‹ˆë‹¤.

### 1.2 ì£¼ìš” ê¸°ëŠ¥
- **NDJSON ë¡œê·¸ íŒŒì‹±**: 7ë‹¨ê³„ (R-01 ~ R-07) ë¡œê·¸ ìë™ ì¶”ì¶œ
- **ë¬´ì†ì‹¤ ë°ì´í„° ë³´ì¡´**: resultData í•„ë“œ ì™„ì „ ë³´ì¡´
- **4-Sheet Excel ë³´ê³ ì„œ ìƒì„±**:
  - Sheet 1: Step_Summary (ë©”ì¸ ë£¨í‹´ í†µê³„)
  - Sheet 2: Action_Breakdown (ì „ì²´ Action í†µê³„)
  - Sheet 3: ResultData_Analysis (ë¹„ì¦ˆë‹ˆìŠ¤ ì§€í‘œ)
  - **Sheet 4: Raw_Data (ì›ë³¸ JSON ë°ì´í„°)** â† v2.1 ì¶”ê°€
- **ë³‘ëª© ë¶„ì„**: í‰ê· /ì¤‘ì•™ê°’/P95 ê¸°ë°˜ ì„±ëŠ¥ ë¶„ì„

### 1.3 ë³€ê²½ ì´ë ¥

| ë²„ì „ | ë‚ ì§œ | ë³€ê²½ ë‚´ìš© |
|------|------|-----------|
| v1.0 | 2025-01-23 | ì´ˆê¸° ì„¤ê³„ (3-Sheet êµ¬ì¡°) |
| v2.0 | 2025-01-24 | ë¬´ì†ì‹¤ ë³´ì¡´ ì›ì¹™ ì¶”ê°€, ì„¤ê³„ì„œ ê°œì„  |
| **v2.1** | **2025-01-24** | **Sheet 4: Raw_Data ì¶”ê°€** |

---

## 2. ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

### 2.1 2-Layer ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    wherehouse.log (NDJSON)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Layer 1: Data Extractor (íŒŒì‹±/ì •ì œ)            â”‚
â”‚  - r01_data_extractor.py ~ r07_data_extractor.py            â”‚
â”‚  - ê³µí†µ: extractor_utils.py                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             ì¤‘ê°„ íŒŒì¼ (JSON) - ë¬´ì†ì‹¤ ë³´ì¡´                   â”‚
â”‚  - r01_parsed_data.json ~ r07_parsed_data.json              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Layer 2: Report Generator (ë³´ê³ ì„œ ìƒì„±)           â”‚
â”‚  - r01_report_generator.py ~ r07_report_generator.py        â”‚
â”‚  - ê³µí†µ: generator_utils.py                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Excel ë³´ê³ ì„œ (4-Sheet) â† v2.1 ë³€ê²½             â”‚
â”‚  - r01_analysis.xlsx ~ r07_analysis.xlsx                    â”‚
â”‚  - Sheet 1~3: í†µê³„ / Sheet 4: ì›ë³¸ ë°ì´í„°                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 í•µì‹¬ ì„¤ê³„ ì›ì¹™

| ì›ì¹™ | ì„¤ëª… |
|------|------|
| **ë¬´ì†ì‹¤ ë³´ì¡´** | resultData í•„ë“œ ì „ì²´ ë³´ì¡´ (ì¤‘ê°„ íŒŒì¼) |
| **ì„ íƒì  ì¶”ì¶œ** | Generatorì—ì„œ í•„ìš”í•œ ì§€í‘œë§Œ ì„ íƒ (Sheet 3) |
| **ì›ë³¸ ë³´ê¸°** | Sheet 4ì—ì„œ JSON ë°ì´í„° ì§ì ‘ í™•ì¸ ê°€ëŠ¥ â† v2.1 |
| **ë‹¨ê³„ë³„ ë…ë¦½ì„±** | ê° R-0X ë‹¨ê³„ëŠ” ë…ë¦½ì ìœ¼ë¡œ ì‹¤í–‰ ê°€ëŠ¥ |
| **ì¬ì‚¬ìš©ì„±** | ê³µí†µ í•¨ìˆ˜ëŠ” common/ ë””ë ‰í† ë¦¬ì— ì§‘ì¤‘ |

---

## 3. ë””ë ‰í† ë¦¬ êµ¬ì¡°

```
E:\devSpace\
â”œâ”€â”€ SpringBootProjects\
â”‚   â””â”€â”€ wherehouse_SpringBoot-master\
â”‚       â””â”€â”€ wherehouse\
â”‚           â””â”€â”€ log\
â”‚               â””â”€â”€ wherehouse.log          # ì…ë ¥ ë¡œê·¸ íŒŒì¼
â”‚
â”œâ”€â”€ results\                                # ì¶œë ¥ ë””ë ‰í† ë¦¬
â”‚   â”œâ”€â”€ r01\
â”‚   â”‚   â”œâ”€â”€ r01_parsed_data.json           # ì¤‘ê°„ íŒŒì¼
â”‚   â”‚   â””â”€â”€ r01_analysis.xlsx              # ìµœì¢… ë³´ê³ ì„œ (4-Sheet)
â”‚   â”œâ”€â”€ r02\
â”‚   â”œâ”€â”€ r03\
â”‚   â”œâ”€â”€ r04\
â”‚   â”œâ”€â”€ r05\
â”‚   â”œâ”€â”€ r06\
â”‚   â””â”€â”€ r07\
â”‚
â””â”€â”€ scripts\
    â”œâ”€â”€ common\
    â”‚   â”œâ”€â”€ extractor_utils.py             # ê³µí†µ Extractor í•¨ìˆ˜
    â”‚   â””â”€â”€ generator_utils.py             # ê³µí†µ Generator í•¨ìˆ˜
    â”œâ”€â”€ extractors\
    â”‚   â”œâ”€â”€ r01_data_extractor.py          # R-01 ì¶”ì¶œ ìŠ¤í¬ë¦½íŠ¸
    â”‚   â”œâ”€â”€ r02_data_extractor.py
    â”‚   â”œâ”€â”€ r03_data_extractor.py
    â”‚   â”œâ”€â”€ r04_data_extractor.py
    â”‚   â”œâ”€â”€ r05_data_extractor.py
    â”‚   â”œâ”€â”€ r06_data_extractor.py
    â”‚   â””â”€â”€ r07_data_extractor.py
    â””â”€â”€ generators\
        â”œâ”€â”€ r01_report_generator.py        # R-01 ë³´ê³ ì„œ ìƒì„±
        â”œâ”€â”€ r02_report_generator.py
        â”œâ”€â”€ r03_report_generator.py
        â”œâ”€â”€ r04_report_generator.py
        â”œâ”€â”€ r05_report_generator.py
        â”œâ”€â”€ r06_report_generator.py
        â””â”€â”€ r07_report_generator.py
```

---

## 4. ê³µí†µ ë¼ì´ë¸ŒëŸ¬ë¦¬ (Common Layer)

### 4.1 extractor_utils.py

ì¶”ì¶œ ê³„ì¸µì˜ ê³µí†µ í•¨ìˆ˜ ëª¨ìŒ

| í•¨ìˆ˜ëª… | ì„¤ëª… | ë°˜í™˜ê°’ |
|--------|------|--------|
| `parse_ndjson_log()` | NDJSON ë¡œê·¸ íŒŒì‹± | List[Dict] |
| `clean_log_data()` | ì¤‘ë³µ ì œê±°, duration_ms ê³„ì‚° | List[Dict] |
| `extract_result_data()` | resultData ë¬´ì†ì‹¤ ë³´ì¡´ | List[Dict] |
| `create_metadata()` | ë©”íƒ€ë°ì´í„° ìƒì„± | Dict |
| `save_to_json()` | JSON íŒŒì¼ ì €ì¥ | None |
| `validate_parsed_data()` | ë°ì´í„° ìœ íš¨ì„± ê²€ì¦ | bool |

**í•µì‹¬ ì½”ë“œ ì˜ˆì‹œ**:
```python
def extract_result_data(logs: List[Dict], step: str) -> List[Dict]:
    """
    resultData í•„ë“œ ì¶”ì¶œ (ë¬´ì†ì‹¤ ë³´ì¡´ ì›ì¹™)
    
    CRITICAL ì›ì¹™:
    - resultDataì˜ ëª¨ë“  í•„ë“œë¥¼ ìˆëŠ” ê·¸ëŒ€ë¡œ ë³´ì¡´
    - í‰íƒ„í™”, í•„í„°ë§, ë³€í™˜ ì¼ì²´ ê¸ˆì§€
    """
    # ì•„ë¬´ê²ƒë„ í•˜ì§€ ì•ŠìŒ - ì›ë³¸ ê·¸ëŒ€ë¡œ ë°˜í™˜
    return logs
```

---

### 4.2 generator_utils.py

ë³´ê³ ì„œ ìƒì„± ê³„ì¸µì˜ ê³µí†µ í•¨ìˆ˜ ëª¨ìŒ

| í•¨ìˆ˜ëª… | ì„¤ëª… | ë°˜í™˜ê°’ |
|--------|------|--------|
| `load_parsed_data()` | ì¤‘ê°„ JSON ë¡œë“œ | Dict |
| `create_step_summary_sheet()` | Sheet 1 ìƒì„± | None |
| `create_action_breakdown_sheet()` | Sheet 2 ìƒì„± | None |
| `create_resultdata_sheet_base()` | Sheet 3 ìƒì„± ë² ì´ìŠ¤ | None |
| **`create_raw_data_sheet()`** â† v2.1 | **Sheet 4 ìƒì„±** | **None** |
| `extract_nested_field()` | ì¤‘ì²© í•„ë“œ ì¶”ì¶œ | Any |
| `validate_excel_output()` | Excel ê²€ì¦ (3+1 Sheet) | bool |

**v2.1 ì¶”ê°€ í•¨ìˆ˜**:
```python
def create_raw_data_sheet(df: pd.DataFrame, 
                          writer, 
                          sheet_name='Raw_Data',
                          include_json_string=True):
    """
    Sheet 4: Raw_Data ìƒì„± - END ë¡œê·¸ì˜ ì›ë³¸ ë°ì´í„° ì €ì¥
    
    Args:
        include_json_string: 
            - True: resultDataë¥¼ JSON ë¬¸ìì—´ë¡œ ì €ì¥ (ê¸°ë³¸)
            - False: resultDataë¥¼ í‰íƒ„í™”í•˜ì—¬ ê°œë³„ ì»¬ëŸ¼ ì €ì¥
    
    ì»¬ëŸ¼:
        - ê¸°ë³¸: traceId, timestamp, step, layer, class, method, action, status
        - ì„±ëŠ¥: duration_ms
        - ì›ë³¸: resultData_JSON (JSON ë¬¸ìì—´)
    """
```

**v2.1 ìˆ˜ì • í•¨ìˆ˜**:
```python
def validate_excel_output(output_file: str, strict_mode: bool = False) -> bool:
    """
    ìƒì„±ëœ Excel íŒŒì¼ ìœ íš¨ì„± ê²€ì¦
    
    Args:
        strict_mode: 
            - False: 3ê°œ í•„ìˆ˜ ì‹œíŠ¸ë§Œ ê²€ì¦ (ê¸°ë³¸, í•˜ìœ„ í˜¸í™˜)
            - True: 4ê°œ ì‹œíŠ¸ ëª¨ë‘ ê²€ì¦
    
    ê²€ì¦:
        - í•„ìˆ˜: Step_Summary, Action_Breakdown, ResultData_Analysis
        - ì„ íƒ: Raw_Data (strict_mode=Trueì¸ ê²½ìš°)
    """
```

---

## 5. ë°ì´í„° ì¶”ì¶œ ê³„ì¸µ (Extractor Layer)

### 5.1 r0X_data_extractor.py í…œí”Œë¦¿

```python
"""
R-0X Data Extractor
"""
import sys
import os
from pathlib import Path

sys.path.append(str(Path(__file__).parent.parent / 'common'))
from extractor_utils import (
    parse_ndjson_log,
    clean_log_data,
    extract_result_data,
    create_metadata,
    save_to_json,
    validate_parsed_data
)

def main():
    # ê²½ë¡œ ì„¤ì •
    LOG_BASE_PATH = r'E:\devSpace\...\log'
    RESULT_BASE_PATH = r'E:\devSpace\results'
    
    config = {
        'step': 'R-0X',
        'log_file': os.path.join(LOG_BASE_PATH, 'wherehouse.log'),
        'output_dir': os.path.join(RESULT_BASE_PATH, 'r0X'),
        'output_file': 'r0X_parsed_data.json'
    }
    
    # 1. ë¡œê·¸ íŒŒì‹±
    logs = parse_ndjson_log(config['log_file'], config['step'])
    
    # 2. ë°ì´í„° ì •ì œ
    logs = clean_log_data(logs)
    
    # 3. resultData ë¬´ì†ì‹¤ ë³´ì¡´
    logs = extract_result_data(logs, config['step'])
    
    # 4. ë©”íƒ€ë°ì´í„° ìƒì„±
    metadata = create_metadata(config, logs)
    
    # 5. ê²€ì¦
    data = {'metadata': metadata, 'logs': logs}
    validate_parsed_data(data)
    
    # 6. ì €ì¥
    output_path = Path(config['output_dir']) / config['output_file']
    save_to_json(data, output_path)

if __name__ == '__main__':
    main()
```

---

## 6. ë³´ê³ ì„œ ìƒì„± ê³„ì¸µ (Generator Layer)

### 6.1 r0X_report_generator.py í…œí”Œë¦¿

```python
"""
R-0X Report Generator
"""
import sys
import os
from pathlib import Path
import pandas as pd

sys.path.append(str(Path(__file__).parent.parent / 'common'))
from generator_utils import (
    load_parsed_data,
    create_step_summary_sheet,
    create_action_breakdown_sheet,
    create_resultdata_sheet_base,
    create_raw_data_sheet,  # â† v2.1 ì¶”ê°€
    validate_excel_output
)

def create_r0X_resultdata_sheet(df: pd.DataFrame, writer):
    """R-0X ì „ìš© ResultData_Analysis ì‹œíŠ¸"""
    metrics_config = {
        # ë‹¨ê³„ë³„ ì§€í‘œ ì •ì˜
    }
    create_resultdata_sheet_base(df, writer, metrics_config, 'ResultData_Analysis')

def main():
    RESULT_BASE_PATH = r'E:\devSpace\results'
    
    config = {
        'step': 'R-0X',
        'input_file': os.path.join(RESULT_BASE_PATH, 'r0X', 'r0X_parsed_data.json'),
        'output_file': os.path.join(RESULT_BASE_PATH, 'r0X', 'r0X_analysis.xlsx')
    }
    
    # 1. ë¡œë“œ
    data = load_parsed_data(config['input_file'])
    df = pd.DataFrame(data['logs'])
    
    # 2. Excel ìƒì„± (4-Sheet) â† v2.1 ë³€ê²½
    with pd.ExcelWriter(config['output_file'], engine='openpyxl') as writer:
        create_step_summary_sheet(df, writer, 'Step_Summary')
        create_action_breakdown_sheet(df, writer, 'Action_Breakdown')
        create_r0X_resultdata_sheet(df, writer)
        create_raw_data_sheet(df, writer, 'Raw_Data')  # â† v2.1 ì¶”ê°€
    
    # 3. ê²€ì¦
    validate_excel_output(config['output_file'])

if __name__ == '__main__':
    main()
```

---

## 7. Excel ë³´ê³ ì„œ êµ¬ì¡° (4-Sheet)

### 7.1 Sheet 1: Step_Summary

**ëª©ì **: ë©”ì¸ ë£¨í‹´ (Service ë ˆì´ì–´) ì„±ëŠ¥ ìš”ì•½

| ì»¬ëŸ¼ | ì„¤ëª… | ì˜ˆì‹œ |
|------|------|------|
| step | ë‹¨ê³„ | R-01 |
| action | ì•¡ì…˜ëª… | calculate9BlockGrid |
| layer | ë ˆì´ì–´ | Service |
| class | í´ë˜ìŠ¤ëª… | LocationAnalysisServiceImpl |
| method | ë©”ì„œë“œëª… | calculate9BlockGrid |
| avg_ms | í‰ê·  (ms) | 24.5 |
| median_ms | ì¤‘ì•™ê°’ (ms) | 23.0 |
| p95_ms | 95 í¼ì„¼íƒ€ì¼ (ms) | 30.0 |
| min_ms | ìµœì†Œ (ms) | 20.0 |
| max_ms | ìµœëŒ€ (ms) | 35.0 |
| std_ms | í‘œì¤€í¸ì°¨ (ms) | 3.2 |
| count | í˜¸ì¶œ íšŸìˆ˜ | 150 |

**ë³‘ëª© ì‹ë³„**: avg_ms, p95_msê°€ ë†’ì€ ìˆœìœ¼ë¡œ ì •ë ¬

---

### 7.2 Sheet 2: Action_Breakdown

**ëª©ì **: ëª¨ë“  ë ˆì´ì–´ì˜ Action ì„±ëŠ¥ ë¶„í•´

| ì»¬ëŸ¼ | ì„¤ëª… |
|------|------|
| step | ë‹¨ê³„ |
| layer | ë ˆì´ì–´ (Service, Repository, Utility ë“±) |
| class | í´ë˜ìŠ¤ëª… |
| method | ë©”ì„œë“œëª… |
| action | ì•¡ì…˜ëª… |
| avg_ms ~ count | Sheet 1ê³¼ ë™ì¼ |

**ìš©ë„**: 
- Service â†’ Repository í˜¸ì¶œ ê´€ê³„ ì¶”ì 
- Utility ê³„ì¸µ ì„±ëŠ¥ ì¸¡ì •

---

### 7.3 Sheet 3: ResultData_Analysis

**ëª©ì **: ë¹„ì¦ˆë‹ˆìŠ¤ ì§€í‘œ ë¶„ì„ (ë‹¨ê³„ë³„ ì»¤ìŠ¤í„°ë§ˆì´ì§•)

| ì»¬ëŸ¼ | ì„¤ëª… | ì˜ˆì‹œ |
|------|------|------|
| metric_name | ì§€í‘œëª… | totalGridCount |
| avg | í‰ê·  | 9.0 |
| median | ì¤‘ì•™ê°’ | 9.0 |
| p95 | 95 í¼ì„¼íƒ€ì¼ | 9.0 |
| min | ìµœì†Œ | 9 |
| max | ìµœëŒ€ | 9 |
| description | ì§€í‘œ ì„¤ëª… | 9-Block ê°œìˆ˜ (í•­ìƒ 9) |

**ë‹¨ê³„ë³„ ì§€í‘œ ì˜ˆì‹œ**:
- R-01: totalGridCount, success_rate
- R-02: l1CacheHit, l2TotalHits, l2TotalMisses
- R-04: amenityResults ê°œìˆ˜, API í˜¸ì¶œ íšŸìˆ˜
- R-05: cctvFilter, policeQuery í†µê³„

---

### 7.4 Sheet 4: Raw_Data â† v2.1 ì¶”ê°€

**ëª©ì **: ì›ë³¸ JSON ë°ì´í„° ë³´ê¸° ë° ê²€ì¦

| ì»¬ëŸ¼ | ì„¤ëª… | ì˜ˆì‹œ |
|------|------|------|
| traceId | ìš”ì²­ ì¶”ì  ID | 27ec5af0 |
| timestamp | ë¡œê·¸ ì‹œê° | 2025-10-23T07:36:55.267940Z |
| step | ë‹¨ê³„ | R-01 |
| layer | ë ˆì´ì–´ | Service |
| class | í´ë˜ìŠ¤ëª… | LocationAnalysisServiceImpl |
| method | ë©”ì„œë“œëª… | calculate9BlockGrid |
| action | ì•¡ì…˜ëª… | calculate9BlockGrid |
| status | ìƒíƒœ | END |
| duration_ms | ì‹¤í–‰ ì‹œê°„ (ms) | 24 |
| **resultData_JSON** | **ì›ë³¸ JSON ë¬¸ìì—´** | {"requestLatitude":37.5663,...} |

**íŠ¹ì§•**:
- âœ… END ë¡œê·¸ë§Œ í¬í•¨ (START ì œì™¸)
- âœ… resultDataë¥¼ JSON ë¬¸ìì—´ë¡œ ì €ì¥ (ê¸°ë³¸ ì˜µì…˜)
- âœ… Excelì—ì„œ í•„í„°/ì •ë ¬ ê°€ëŠ¥
- âœ… ì›ë³¸ ë°ì´í„° ì§ì ‘ í™•ì¸ ê°€ëŠ¥

**ì˜µì…˜ 2 - í‰íƒ„í™”**:
```python
create_raw_data_sheet(df, writer, 'Raw_Data', include_json_string=False)
```
â†’ `resultData.latitude`, `resultData.longitude` ë“± ê°œë³„ ì»¬ëŸ¼ìœ¼ë¡œ ë¶„ë¦¬

---

## 8. ë‹¨ê³„ë³„ êµ¬í˜„ ëª…ì„¸

### 8.1 R-01: 9-Block ê·¸ë¦¬ë“œ ê³„ì‚°

**ë³‘ëª©**: ì—†ìŒ (ë‹¨ìˆœ ê³„ì‚°)

**Sheet 3 ì§€í‘œ**:
```python
metrics_config = {
    'totalGridCount': {
        'path': 'totalGridCount',
        'description': '9-Block ê·¸ë¦¬ë“œ ê°œìˆ˜ (í•­ìƒ 9)'
    },
    'nineBlockGeohashes_count': {
        'path': 'nineBlockGeohashes',
        'description': 'Geohash ë°°ì—´ ê¸¸ì´',
        'transform': lambda x: len(x) if isinstance(x, list) else 0
    },
    'success_rate': {
        'path': 'success',
        'description': 'ì„±ê³µë¥  (%)',
        'transform': lambda x: 100.0 if x else 0.0
    }
}
```

**Sheet 4**: 2ê°œ ë¡œê·¸ (Service + Utility)

---

### 8.2 R-02: ìºì‹œ ì¡°íšŒ (B-03 ë³‘ëª©)

**ë³‘ëª©**: L2 ìºì‹œ N+1 ì¿¼ë¦¬

**Sheet 3 ì§€í‘œ**:
```python
metrics_config = {
    'l1CacheHit': {
        'path': 'l1CacheHit',
        'description': 'L1 ìºì‹œ íˆíŠ¸ ì—¬ë¶€ (%)',
        'transform': lambda x: 100.0 if x else 0.0
    },
    'l2TotalHits': {
        'path': 'l2TotalHits',
        'description': 'L2 ìºì‹œ íˆíŠ¸ ìˆ˜ (í‰ê· )'
    },
    'l2TotalMisses': {
        'path': 'l2TotalMisses',
        'description': 'L2 ìºì‹œ ë¯¸ìŠ¤ ìˆ˜ (í‰ê· )'
    },
    'l2CacheTotalDurationNs': {
        'path': 'l2CacheTotalDurationNs',
        'description': 'L2 ìºì‹œ ì´ ì†Œìš” ì‹œê°„ (ns)',
        'transform': lambda x: x / 1_000_000  # ns â†’ ms ë³€í™˜
    }
}
```

**Sheet 4**: L2 ìºì‹œ 9ë²ˆ ì¡°íšŒ ìƒì„¸ (l2CacheResults ë°°ì—´)

---

### 8.3 R-03: DB ì¿¼ë¦¬

**Sheet 3 ì§€í‘œ**:
```python
metrics_config = {
    'cctvTotalRowsReturned': {
        'path': 'cctvQueryResult.totalRowsReturned',
        'description': 'CCTV DB ì¡°íšŒ ê²°ê³¼ ê°œìˆ˜'
    },
    'cctvQueryExecutionTimeMs': {
        'path': 'cctvQueryResult.queryExecutionTimeNs',
        'description': 'CCTV ì¿¼ë¦¬ ì‹¤í–‰ ì‹œê°„ (ms)',
        'transform': lambda x: x / 1_000_000
    }
}
```

**Sheet 4**: DB ì¿¼ë¦¬ ê²°ê³¼ ë° ìºì‹œ ì“°ê¸° ìƒì„¸

---

### 8.4 R-04: ì™¸ë¶€ API í˜¸ì¶œ (B-02 ë³‘ëª©)

**ë³‘ëª©**: Amenity API ìˆœì°¨ í˜¸ì¶œ

**Sheet 3 ì§€í‘œ**:
```python
metrics_config = {
    'totalSequentialTasks': {
        'path': 'totalSequentialTasks',
        'description': 'ìˆœì°¨ ì‘ì—… ê°œìˆ˜ (í•­ìƒ 3)'
    },
    'totalExecutionTimeMs': {
        'path': 'totalExecutionTimeNs',
        'description': 'ì „ì²´ ì‹¤í–‰ ì‹œê°„ (ms)',
        'transform': lambda x: x / 1_000_000
    },
    'amenityTotalPlaces': {
        'path': 'amenityApiResult.totalPlaces',
        'description': 'Amenity API ê²°ê³¼ ê°œìˆ˜'
    },
    'amenityExecutionTimeMs': {
        'path': 'amenityApiResult.executionTimeNs',
        'description': 'Amenity API ì†Œìš” ì‹œê°„ (ms)',
        'transform': lambda x: x / 1_000_000
    }
}
```

**Sheet 4**: 3ê°œ API (ì£¼ì†Œ, ê²€ê±°ìœ¨, í¸ì˜ì‹œì„¤) ìƒì„¸ ê²°ê³¼

---

### 8.5 R-05: ë°ì´í„° í†µí•© ë° í•„í„°ë§ (B-01 ë³‘ëª©)

**ë³‘ëª©**: íŒŒì¶œì†Œ Native Query (221ms)

**Sheet 3 ì§€í‘œ**:
```python
metrics_config = {
    'cctvFilterRate': {
        'path': 'cctvFilter.filterRate',
        'description': 'CCTV í•„í„°ë§ ë¹„ìœ¨ (%)',
        'transform': lambda x: x * 100
    },
    'policeQueryDurationMs': {
        'path': 'policeQuery.queryDurationNs',
        'description': 'íŒŒì¶œì†Œ ì¿¼ë¦¬ ì†Œìš” ì‹œê°„ (ms)',
        'transform': lambda x: x / 1_000_000
    },
    'policeNearestDistance': {
        'path': 'policeQuery.nearestDistance',
        'description': 'ê°€ì¥ ê°€ê¹Œìš´ íŒŒì¶œì†Œ ê±°ë¦¬ (m)'
    }
}
```

**Sheet 4**: CCTV í•„í„°ë§, íŒŒì¶œì†Œ ì¿¼ë¦¬, í¸ì˜ì‹œì„¤ í•„í„°ë§ ìƒì„¸

---

### 8.6 R-06: ì ìˆ˜ ê³„ì‚°

**Sheet 3 ì§€í‘œ**:
```python
metrics_config = {
    'safetyScore': {
        'path': 'safetyScore.finalScore',
        'description': 'ì•ˆì „ ì ìˆ˜'
    },
    'convenienceScore': {
        'path': 'convenienceScore.finalScore',
        'description': 'í¸ì˜ ì ìˆ˜'
    },
    'overallScore': {
        'path': 'overallScore',
        'description': 'ì¢…í•© ì ìˆ˜'
    }
}
```

**Sheet 4**: ì ìˆ˜ ê³„ì‚° ìƒì„¸ (ê°€ì¤‘ì¹˜, ê°œë³„ ì ìˆ˜ ë“±)

---

### 8.7 R-07: ìµœì¢… ì‘ë‹µ ìƒì„±

**Sheet 3 ì§€í‘œ**:
```python
metrics_config = {
    'responseSizeBytes': {
        'path': 'responseSizeBytes',
        'description': 'ì‘ë‹µ í¬ê¸° (bytes)'
    },
    'cacheWriteSuccess': {
        'path': 'cacheWrite.success',
        'description': 'ìºì‹œ ì“°ê¸° ì„±ê³µë¥  (%)',
        'transform': lambda x: 100.0 if x else 0.0
    }
}
```

**Sheet 4**: ìºì‹œ ì“°ê¸° ê²°ê³¼ ë° ìµœì¢… ì‘ë‹µ ìƒì„¸

---

## 9. ì‹¤í–‰ ë°©ë²•

### 9.1 ì „ì²´ íŒŒì´í”„ë¼ì¸ ì‹¤í–‰

```bash
# 1. R-01 ì¶”ì¶œ
cd E:\devSpace\scripts\extractors
python r01_data_extractor.py

# ì¶œë ¥ ì˜ˆì‹œ:
# ======================================================================
# R-01 Data Extractor ì‹œì‘
# ======================================================================
# ë¡œê·¸ íŒŒì¼: E:\devSpace\...\wherehouse.log
# ì¶œë ¥ ë””ë ‰í† ë¦¬: E:\devSpace\results\r01
# ----------------------------------------------------------------------
# 
# [1/6] ë¡œê·¸ íŒŒì‹± ì¤‘...
#   - ë¡œê·¸ íŒŒì¼ ì½ëŠ” ì¤‘: E:\devSpace\...\wherehouse.log
#   âœ“ íŒŒì‹± ì™„ë£Œ: 4ê°œ ë¡œê·¸
# 
# [2/6] ë°ì´í„° ì •ì œ ì¤‘...
#   âœ“ ì •ì œ ì™„ë£Œ: 4ê°œ ë¡œê·¸
# 
# [3/6] resultData ì¶”ì¶œ ì¤‘...
#   âœ“ END ë¡œê·¸: 2ê°œ
#   âœ“ resultData í•„ë“œ: latitude, longitude, precision, centerHash, ...
# 
# [4/6] ë©”íƒ€ë°ì´í„° ìƒì„± ì¤‘...
#   âœ“ step: R-01
#   âœ“ total_logs: 4
#   âœ“ end_logs: 2
# 
# [5/6] ë°ì´í„° ê²€ì¦ ì¤‘...
#   âœ“ ê²€ì¦ í†µê³¼
# 
# [6/6] JSON íŒŒì¼ ì €ì¥ ì¤‘...
#   - íŒŒì¼ í¬ê¸°: 0.00 MB
# 
# ======================================================================
# âœ… R-01 ì¶”ì¶œ ì™„ë£Œ!
# âœ… ì¶œë ¥ íŒŒì¼: E:\devSpace\results\r01\r01_parsed_data.json
# ======================================================================

# 2. R-01 ë³´ê³ ì„œ ìƒì„±
cd E:\devSpace\scripts\generators
python r01_report_generator.py

# ì¶œë ¥ ì˜ˆì‹œ:
# ======================================================================
# R-01 Report Generator ì‹œì‘
# ======================================================================
# ì…ë ¥ íŒŒì¼: E:\devSpace\results\r01\r01_parsed_data.json
# ì¶œë ¥ íŒŒì¼: E:\devSpace\results\r01\r01_analysis.xlsx
# ----------------------------------------------------------------------
# 
# [1/4] ì¤‘ê°„ íŒŒì¼ ë¡œë“œ ì¤‘...
#   - ë©”íƒ€ë°ì´í„°: R-01, ì´ 4ê°œ ë¡œê·¸, END 2ê°œ
#   âœ“ ë¡œë“œ ì™„ë£Œ: 4ê°œ ë¡œê·¸
# 
# [2/4] ë°ì´í„° í™•ì¸ ì¤‘...
#   âœ“ START ë¡œê·¸: 2ê°œ
#   âœ“ END ë¡œê·¸: 2ê°œ
#   âœ“ ë ˆì´ì–´ ë¶„í¬:
#       - Service: 2ê°œ
#       - Utility: 2ê°œ
# 
# [3/4] Excel ë³´ê³ ì„œ ìƒì„± ì¤‘...
#   - Sheet 1: Step_Summary
#   - Step_Summary: 1ê°œ ë©”ì¸ ë£¨í‹´
#   - Sheet 2: Action_Breakdown
#   - Action_Breakdown: 2ê°œ Action
#   - Sheet 3: ResultData_Analysis
#   - ResultData_Analysis: 3ê°œ ì§€í‘œ
#   - Sheet 4: Raw_Data
#   - Raw_Data: 2ê°œ ë¡œê·¸ (resultDataëŠ” JSON ë¬¸ìì—´)
#   âœ“ Excel ìƒì„± ì™„ë£Œ
# 
# [4/4] Excel íŒŒì¼ ê²€ì¦ ì¤‘...
#   âœ“ Excel ê²€ì¦ ì™„ë£Œ: 4ê°œ ì‹œíŠ¸
# 
# ======================================================================
# âœ… R-01 ë³´ê³ ì„œ ìƒì„± ì™„ë£Œ!
# âœ… ì¶œë ¥ íŒŒì¼: E:\devSpace\results\r01\r01_analysis.xlsx
# ======================================================================

# 3. ê²°ê³¼ í™•ì¸
start E:\devSpace\results\r01\r01_analysis.xlsx
```

### 9.2 ëª¨ë“  ë‹¨ê³„ ì¼ê´„ ì‹¤í–‰ (ë°°ì¹˜ ìŠ¤í¬ë¦½íŠ¸)

**run_all_analysis.bat**:
```batch
@echo off
cd /d E:\devSpace\scripts

echo [1/7] R-01 ë¶„ì„ ì‹œì‘...
python extractors\r01_data_extractor.py
python generators\r01_report_generator.py

echo [2/7] R-02 ë¶„ì„ ì‹œì‘...
python extractors\r02_data_extractor.py
python generators\r02_report_generator.py

REM ... R-03 ~ R-07 ë°˜ë³µ ...

echo ëª¨ë“  ë¶„ì„ ì™„ë£Œ!
pause
```

---

## 10. íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### 10.1 ë¡œê·¸ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤

**ì¦ìƒ**:
```
âŒ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: E:\devSpace\...\wherehouse.log
```

**í•´ê²°**:
1. ìŠ¤í¬ë¦½íŠ¸ ìƒë‹¨ì˜ `LOG_BASE_PATH` ê²½ë¡œ í™•ì¸
2. wherehouse.log íŒŒì¼ ì¡´ì¬ ì—¬ë¶€ í™•ì¸
3. ê²½ë¡œì— í•œê¸€ì´ë‚˜ íŠ¹ìˆ˜ë¬¸ìê°€ ìˆëŠ”ì§€ í™•ì¸

---

### 10.2 ì¤‘ê°„ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤

**ì¦ìƒ**:
```
âŒ íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: E:\devSpace\results\r01\r01_parsed_data.json
```

**í•´ê²°**:
1. ë¨¼ì € Extractorë¥¼ ì‹¤í–‰í–ˆëŠ”ì§€ í™•ì¸
2. `RESULT_BASE_PATH` ê²½ë¡œ í™•ì¸
3. ìˆ˜ë™ìœ¼ë¡œ ë””ë ‰í† ë¦¬ ìƒì„±: `mkdir E:\devSpace\results\r01`

---

### 10.3 Sheet 4ì— ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤

**ì¦ìƒ**:
Sheet 4ê°€ ë¹„ì–´ìˆê±°ë‚˜ ë¡œê·¸ê°€ ì—†ìŒ

**í•´ê²°**:
1. END ë¡œê·¸ê°€ ìˆëŠ”ì§€ í™•ì¸ (STARTë§Œ ìˆìœ¼ë©´ Sheet 4 ìƒì„± ì•ˆ ë¨)
2. ì¤‘ê°„ íŒŒì¼(JSON)ì—ì„œ `"status": "END"` ë¡œê·¸ í™•ì¸
3. ë¡œê·¸ íŒŒì¼ì—ì„œ í•´ë‹¹ stepì˜ PERFORMANCE ë¡œê·¸ í™•ì¸

---

### 10.4 resultData_JSONì´ ì˜ë¦½ë‹ˆë‹¤

**ì¦ìƒ**:
Excelì—ì„œ JSON ë¬¸ìì—´ì´ ë„ˆë¬´ ê¸¸ì–´ì„œ ì˜ë¦¼

**ì›ì¸**:
- Excel ì…€ í‘œì‹œ ì œí•œ (32,767ì)
- R-04ì²˜ëŸ¼ amenityResultsê°€ í° ê²½ìš° JSONì´ ë§¤ìš° ê¸¸ì–´ì§

**í•´ê²° ë°©ë²• 1**: í‰íƒ„í™” ì˜µì…˜ ì‚¬ìš© (ê¶Œì¥)
```python
# r0X_report_generator.py ìˆ˜ì •
create_raw_data_sheet(df, writer, 'Raw_Data', include_json_string=False)
```
â†’ `resultData.latitude`, `resultData.longitude` ë“± ê°œë³„ ì»¬ëŸ¼ìœ¼ë¡œ ë¶„ë¦¬

**í•´ê²° ë°©ë²• 2**: Excelì—ì„œ ì»¬ëŸ¼ ë„ˆë¹„ ì¡°ì •
- Sheet 4 â†’ resultData_JSON ì»¬ëŸ¼ ë”ë¸”í´ë¦­ (ìë™ ì¡°ì •)
- ë‹¨, 32,767ìë¥¼ ì´ˆê³¼í•˜ë©´ ì—¬ì „íˆ ì˜ë¦¼

**í•´ê²° ë°©ë²• 3**: JSON íŒŒì¼ ì§ì ‘ í™•ì¸ (ì œí•œ ì—†ìŒ)
- `r0X_parsed_data.json` íŒŒì¼ì„ VS Code ë“±ìœ¼ë¡œ ì—´ê¸°
- ì „ì²´ JSON ë°ì´í„°ë¥¼ ì˜¨ì „íˆ í™•ì¸ ê°€ëŠ¥

**ì°¸ê³ **: Sheet 4ëŠ” "ë³´ê¸° í¸ì˜" ëª©ì ì´ë¯€ë¡œ, ì™„ì „í•œ ë°ì´í„°ëŠ” í•­ìƒ JSON íŒŒì¼ì— ë³´ì¡´ë¨

---

## 11. ë¶€ë¡

### 11.1 ì˜ì¡´ì„± íŒ¨í‚¤ì§€

```
pandas
openpyxl
```

**ì„¤ì¹˜**:
```bash
pip install pandas openpyxl
```

---

### 11.2 ë¡œê·¸ êµ¬ì¡° ì˜ˆì‹œ

```json
{
  "timestamp": "2025-10-23T07:36:55.280938900Z",
  "nanoTime": 21466984472500,
  "traceId": "27ec5af0",
  "thread": "http-nio-8185-exec-2",
  "eventType": "PERFORMANCE",
  "step": "R-01",
  "layer": "Service",
  "class": "LocationAnalysisServiceImpl",
  "method": "calculate9BlockGrid",
  "action": "calculate9BlockGrid",
  "status": "END",
  "duration_ns": 24653800,
  "duration_ms": 24,
  "resultData": {
    "requestLatitude": 37.5663,
    "requestLongitude": 126.9779,
    "requestRadius": 500,
    "centerGeohashId": "wydm9qw",
    "nineBlockGeohashes": ["wydm9qw", "wydm9qy", ...],
    "totalGridCount": 9,
    "errorMessage": null,
    "success": true
  }
}
```

---

### 11.3 ì£¼ìš” ë³€ê²½ ì‚¬í•­ (v2.0 â†’ v2.1)

| í•­ëª© | v2.0 | v2.1 |
|------|------|------|
| Sheet ê°œìˆ˜ | 3ê°œ (í•„ìˆ˜) | **4ê°œ (3ê°œ í•„ìˆ˜ + 1ê°œ ì„ íƒ)** |
| ì›ë³¸ ë°ì´í„° í™•ì¸ | JSON íŒŒì¼ë§Œ | **Excel Sheet 4ì—ì„œ ì§ì ‘ í™•ì¸ ê°€ëŠ¥** |
| generator_utils í•¨ìˆ˜ | 6ê°œ | **7ê°œ (`create_raw_data_sheet` ì¶”ê°€)** |
| validate_excel_output | 3-Sheet ê²€ì¦ | **3+1 Sheet ê²€ì¦ (strict_mode ì§€ì›)** |
| Excel ì‚¬ìš©ì„± | í†µê³„ë§Œ í™•ì¸ | **í†µê³„ + ì›ë³¸ ë°ì´í„° í™•ì¸ ê°€ëŠ¥** |

**ì—…ê·¸ë ˆì´ë“œ ê°€ì´ë“œ**:

1. **generator_utils.py êµì²´** (í•„ìˆ˜)
   - `create_raw_data_sheet()` í•¨ìˆ˜ ì¶”ê°€ë¨
   - `validate_excel_output()` í•¨ìˆ˜ ìˆ˜ì •ë¨

2. **ê° r0X_report_generator.py ìˆ˜ì •** (ì„ íƒ)
   ```python
   # import ì¶”ê°€
   from generator_utils import (
       ...,
       create_raw_data_sheet,  # â† ì¶”ê°€
       ...
   )
   
   # Excel ìƒì„± ë¶€ë¶„ì— Sheet 4 ì¶”ê°€
   with pd.ExcelWriter(config['output_file'], engine='openpyxl') as writer:
       create_step_summary_sheet(df, writer, 'Step_Summary')
       create_action_breakdown_sheet(df, writer, 'Action_Breakdown')
       create_r0X_resultdata_sheet(df, writer)
       create_raw_data_sheet(df, writer, 'Raw_Data')  # â† ì¶”ê°€
   ```

3. **ê¸°ì¡´ Excel íŒŒì¼ ì¬ìƒì„±** (ì„ íƒ)
   - ExtractorëŠ” ì¬ì‹¤í–‰ ë¶ˆí•„ìš” (JSON íŒŒì¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©)
   - Generatorë§Œ ì¬ì‹¤í–‰í•˜ë©´ Sheet 4 í¬í•¨ëœ ìƒˆ Excel ìƒì„±

**í•˜ìœ„ í˜¸í™˜ì„±**:
- Sheet 4ëŠ” **ì„ íƒì‚¬í•­**ì´ë¯€ë¡œ ì¶”ê°€í•˜ì§€ ì•Šì•„ë„ ì •ìƒ ë™ì‘
- `validate_excel_output()`ì€ ê¸°ë³¸ì ìœ¼ë¡œ 3ê°œ ì‹œíŠ¸ë§Œ ê²€ì¦ (strict_mode=False)
- ê¸°ì¡´ 3-Sheet Excelë„ ê³„ì† ì‚¬ìš© ê°€ëŠ¥

---

**ë¬¸ì„œ ë**
