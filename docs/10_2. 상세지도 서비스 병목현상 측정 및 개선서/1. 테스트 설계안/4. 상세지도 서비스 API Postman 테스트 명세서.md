# 위치 분석 API Postman 컬렉션 테스트 명세서
## Location Analysis API Postman Test Specification

**문서 정보**
- 문서 유형: API 테스트 명세서 (API Test Specification)
- 문서 버전: 1.3
- 작성일: 2025-01-23
- 작성자: 정범진
- 프로젝트: Wherehouse 위치 기반 정보 분석 서비스
- 대상 API: `POST /api/location-analysis`

---

## Postman 환경 변수 설정

**Environment Name**: Location Analysis API  
**Variables**:
- `base_url`: `http://localhost:8185/wherehouse` (application.yml의 server.port와 context-path 반영)
- `content_type`: `application/json`

---

## 1. Health Check API

### Method: GET
### URL: `{{base_url}}/api/health`

#### Headers:
*None required*

#### Body:
*None*

#### Expected Response:
```
Status: 200 OK
Body: OK
```

---


## 2. 위치 분석 테스트 시리즈 (20개 좌표)

### 2-1. 강남역 인근 분석 (대표 상업지구)

### Method: POST
### URL: `{{base_url}}/api/location-analysis`

#### Headers:
```
Content-Type: application/json
Accept: */*
Origin: http://localhost:8185
```

#### Body (raw JSON):
```json
{
  "latitude": 37.4979,
  "longitude": 127.0276,
  "radius": 500
}
```

#### Tests:
```javascript
pm.test("Status code is 200", function () {
    pm.response.to.have.status(200);
});

pm.test("Response has required fields", function () {
    const jsonData = pm.response.json();
    pm.expect(jsonData).to.have.property('analysis_status');
    pm.expect(jsonData).to.have.property('coordinate');
    pm.expect(jsonData).to.have.property('address');
    pm.expect(jsonData).to.have.property('safety_score');
    pm.expect(jsonData).to.have.property('convenience_score');
    pm.expect(jsonData).to.have.property('overall_score');
});

pm.test("Coordinates match request", function () {
    const jsonData = pm.response.json();
    pm.expect(jsonData.coordinate.latitude).to.eql(37.4979);
    pm.expect(jsonData.coordinate.longitude).to.eql(127.0276);
});

pm.test("Scores are within valid range (0-100)", function () {
    const jsonData = pm.response.json();
    pm.expect(jsonData.safety_score.total).to.be.at.least(0);
    pm.expect(jsonData.safety_score.total).to.be.at.most(100);
    pm.expect(jsonData.convenience_score.total).to.be.at.least(0);
    pm.expect(jsonData.convenience_score.total).to.be.at.most(100);
    pm.expect(jsonData.overall_score).to.be.at.least(0);
    pm.expect(jsonData.overall_score).to.be.at.most(100);
});

pm.test("Address information is present", function () {
    const jsonData = pm.response.json();
    pm.expect(jsonData.address.road_address).to.be.a('string');
    pm.expect(jsonData.address.jibun_address).to.be.a('string');
});

pm.test("Commercial area should have high convenience score", function () {
    const jsonData = pm.response.json();
    console.log(`강남역 편의성 점수: ${jsonData.convenience_score.total}`);
    pm.expect(jsonData.convenience_score.total).to.be.above(60);
});
```

---

### 2-2. 서울역 인근 분석 (교통 중심지)

### Method: POST
### URL: `{{base_url}}/api/location-analysis`

#### Headers:
```
Content-Type: application/json
Accept: */*
Origin: http://localhost:8185
```

#### Body (raw JSON):
```json
{
  "latitude": 37.5547,
  "longitude": 126.9707,
  "radius": 500
}
```

#### Tests:
```javascript
pm.test("Status code is 200", function () {
    pm.response.to.have.status(200);
});

pm.test("Response has required fields", function () {
    const jsonData = pm.response.json();
    pm.expect(jsonData).to.have.property('analysis_status');
    pm.expect(jsonData).to.have.property('safety_score');
    pm.expect(jsonData).to.have.property('convenience_score');
});

pm.test("Transportation hub should have subway station nearby", function () {
    const jsonData = pm.response.json();
    const amenities = jsonData.convenience_score.amenity_details;
    const subwayCategory = amenities.find(a => a.category_code === 'SW8');
    
    if (subwayCategory) {
        console.log(`지하철역 ${subwayCategory.count}개 발견, 최단거리: ${subwayCategory.closest_distance}m`);
        pm.expect(subwayCategory.count).to.be.above(0);
    }
});
```

---

### 2-3. 홍대입구역 인근 분석 (문화/상업 복합지구)

### Method: POST
### URL: `{{base_url}}/api/location-analysis`

#### Headers:
```
Content-Type: application/json
Accept: */*
Origin: http://localhost:8185
```

#### Body (raw JSON):
```json
{
  "latitude": 37.5572,
  "longitude": 126.9239,
  "radius": 500
}
```

#### Tests:
```javascript
pm.test("Status code is 200", function () {
    pm.response.to.have.status(200);
});

pm.test("Cultural district should have restaurants and cafes", function () {
    const jsonData = pm.response.json();
    const amenities = jsonData.convenience_score.amenity_details;
    
    const restaurants = amenities.find(a => a.category_code === 'FD6');
    const cafes = amenities.find(a => a.category_code === 'CE7');
    
    console.log(`음식점: ${restaurants ? restaurants.count : 0}개`);
    console.log(`카페: ${cafes ? cafes.count : 0}개`);
    
    pm.expect(restaurants ? restaurants.count : 0).to.be.above(5);
    pm.expect(cafes ? cafes.count : 0).to.be.above(3);
});
```

---

### 2-4. 여의도 국회의사당 인근 분석 (정치/업무 중심지)

### Method: POST
### URL: `{{base_url}}/api/location-analysis`

#### Headers:
```
Content-Type: application/json
Accept: */*
Origin: http://localhost:8185
```

#### Body (raw JSON):
```json
{
  "latitude": 37.5326,
  "longitude": 126.9135,
  "radius": 500
}
```

#### Tests:
```javascript
pm.test("Status code is 200", function () {
    pm.response.to.have.status(200);
});

pm.test("Government area should have high safety infrastructure", function () {
    const jsonData = pm.response.json();
    console.log(`안전성 점수: ${jsonData.safety_score.total}`);
    console.log(`CCTV 개수: ${jsonData.safety_score.cctv_count}`);
    
    pm.expect(jsonData.safety_score.total).to.be.above(50);
});
```

---

### 2-5. 잠실역 인근 분석 (대형 복합단지)

### Method: POST
### URL: `{{base_url}}/api/location-analysis`

#### Headers:
```
Content-Type: application/json
Accept: */*
Origin: http://localhost:8185
```

#### Body (raw JSON):
```json
{
  "latitude": 37.5133,
  "longitude": 127.1000,
  "radius": 500
}
```

#### Tests:
```javascript
pm.test("Status code is 200", function () {
    pm.response.to.have.status(200);
});

pm.test("Large complex should have high overall score", function () {
    const jsonData = pm.response.json();
    console.log(`종합 점수: ${jsonData.overall_score}`);
    console.log(`편의성: ${jsonData.convenience_score.total}, 안전성: ${jsonData.safety_score.total}`);
    
    pm.expect(jsonData.overall_score).to.be.above(60);
});
```

---

### 2-6. 명동역 인근 분석 (관광/쇼핑 중심지)

### Method: POST
### URL: `{{base_url}}/api/location-analysis`

#### Headers:
```
Content-Type: application/json
Accept: */*
Origin: http://localhost:8185
```

#### Body (raw JSON):
```json
{
  "latitude": 37.5637,
  "longitude": 126.9830,
  "radius": 500
}
```

#### Tests:
```javascript
pm.test("Status code is 200", function () {
    pm.response.to.have.status(200);
});

pm.test("Shopping area should have convenience stores and banks", function () {
    const jsonData = pm.response.json();
    const amenities = jsonData.convenience_score.amenity_details;
    
    const convenienceStores = amenities.find(a => a.category_code === 'CS2');
    const banks = amenities.find(a => a.category_code === 'BK9');
    
    console.log(`편의점: ${convenienceStores ? convenienceStores.count : 0}개`);
    console.log(`은행: ${banks ? banks.count : 0}개`);
});
```

---

### 2-7. 신촌역 인근 분석 (대학가)

### Method: POST
### URL: `{{base_url}}/api/location-analysis`

#### Headers:
```
Content-Type: application/json
Accept: */*
Origin: http://localhost:8185
```

#### Body (raw JSON):
```json
{
  "latitude": 37.5559,
  "longitude": 126.9368,
  "radius": 500
}
```

#### Tests:
```javascript
pm.test("Status code is 200", function () {
    pm.response.to.have.status(200);
});

pm.test("University area should have educational facilities", function () {
    const jsonData = pm.response.json();
    const amenities = jsonData.convenience_score.amenity_details;
    
    const schools = amenities.find(a => a.category_code === 'SC4');
    const academies = amenities.find(a => a.category_code === 'AC5');
    
    console.log(`학교: ${schools ? schools.count : 0}개`);
    console.log(`학원: ${academies ? academies.count : 0}개`);
});
```

---

### 2-8. 광화문 인근 분석 (역사/문화 중심지)

### Method: POST
### URL: `{{base_url}}/api/location-analysis`

#### Headers:
```
Content-Type: application/json
Accept: */*
Origin: http://localhost:8185
```

#### Body (raw JSON):
```json
{
  "latitude": 37.5720,
  "longitude": 126.9769,
  "radius": 500
}
```

#### Tests:
```javascript
pm.test("Status code is 200", function () {
    pm.response.to.have.status(200);
});

pm.test("Historical area should have cultural facilities and tourist attractions", function () {
    const jsonData = pm.response.json();
    const amenities = jsonData.convenience_score.amenity_details;
    
    const cultural = amenities.find(a => a.category_code === 'CT1');
    const tourist = amenities.find(a => a.category_code === 'AT4');
    
    console.log(`문화시설: ${cultural ? cultural.count : 0}개`);
    console.log(`관광명소: ${tourist ? tourist.count : 0}개`);
});
```

---

### 2-9. 건대입구역 인근 분석 (상업/대학 복합지구)

### Method: POST
### URL: `{{base_url}}/api/location-analysis`

#### Headers:
```
Content-Type: application/json
Accept: */*
Origin: http://localhost:8185
```

#### Body (raw JSON):
```json
{
  "latitude": 37.5403,
  "longitude": 127.0695,
  "radius": 500
}
```

#### Tests:
```javascript
pm.test("Status code is 200", function () {
    pm.response.to.have.status(200);
});

pm.test("Mixed commercial-university area should have diverse amenities", function () {
    const jsonData = pm.response.json();
    const amenities = jsonData.convenience_score.amenity_details;
    
    console.log(`총 ${amenities.length}개 카테고리의 편의시설 분석됨`);
    pm.expect(amenities.length).to.be.at.least(10);
});
```

---

### 2-10. 이태원역 인근 분석 (다문화 상업지구)

### Method: POST
### URL: `{{base_url}}/api/location-analysis`

#### Headers:
```
Content-Type: application/json
Accept: */*
Origin: http://localhost:8185
```

#### Body (raw JSON):
```json
{
  "latitude": 37.5344,
  "longitude": 126.9944,
  "radius": 500
}
```

#### Tests:
```javascript
pm.test("Status code is 200", function () {
    pm.response.to.have.status(200);
});

pm.test("Commercial district should have restaurants and parking", function () {
    const jsonData = pm.response.json();
    const amenities = jsonData.convenience_score.amenity_details;
    
    const restaurants = amenities.find(a => a.category_code === 'FD6');
    const parking = amenities.find(a => a.category_code === 'PK6');
    
    console.log(`음식점: ${restaurants ? restaurants.count : 0}개`);
    console.log(`주차장: ${parking ? parking.count : 0}개`);
});
```

---

### 2-11. 성수역 인근 분석 (신흥 상권)

### Method: POST
### URL: `{{base_url}}/api/location-analysis`

#### Headers:
```
Content-Type: application/json
Accept: */*
Origin: http://localhost:8185
```

#### Body (raw JSON):
```json
{
  "latitude": 37.5446,
  "longitude": 127.0558,
  "radius": 500
}
```

#### Tests:
```javascript
pm.test("Status code is 200", function () {
    pm.response.to.have.status(200);
});

pm.test("Emerging commercial area should have cafes", function () {
    const jsonData = pm.response.json();
    const amenities = jsonData.convenience_score.amenity_details;
    
    const cafes = amenities.find(a => a.category_code === 'CE7');
    
    console.log(`카페: ${cafes ? cafes.count : 0}개`);
    pm.expect(cafes ? cafes.count : 0).to.be.above(2);
});
```

---

### 2-12. 종로3가역 인근 분석 (전통 상업지구)

### Method: POST
### URL: `{{base_url}}/api/location-analysis`

#### Headers:
```
Content-Type: application/json
Accept: */*
Origin: http://localhost:8185
```

#### Body (raw JSON):
```json
{
  "latitude": 37.5709,
  "longitude": 126.9920,
  "radius": 500
}
```

#### Tests:
```javascript
pm.test("Status code is 200", function () {
    pm.response.to.have.status(200);
});

pm.test("Traditional commercial area analysis", function () {
    const jsonData = pm.response.json();
    console.log(`종합 점수: ${jsonData.overall_score}`);
    console.log(`주소: ${jsonData.address.road_address}`);
});
```

---

### 2-13. 압구정로데오역 인근 분석 (고급 상권)

### Method: POST
### URL: `{{base_url}}/api/location-analysis`

#### Headers:
```
Content-Type: application/json
Accept: */*
Origin: http://localhost:8185
```

#### Body (raw JSON):
```json
{
  "latitude": 37.5276,
  "longitude": 127.0397,
  "radius": 500
}
```

#### Tests:
```javascript
pm.test("Status code is 200", function () {
    pm.response.to.have.status(200);
});

pm.test("Premium commercial area should have high convenience score", function () {
    const jsonData = pm.response.json();
    console.log(`편의성 점수: ${jsonData.convenience_score.total}`);
    pm.expect(jsonData.convenience_score.total).to.be.above(55);
});
```

---

### 2-14. 삼성역 인근 분석 (업무지구)

### Method: POST
### URL: `{{base_url}}/api/location-analysis`

#### Headers:
```
Content-Type: application/json
Accept: */*
Origin: http://localhost:8185
```

#### Body (raw JSON):
```json
{
  "latitude": 37.5087,
  "longitude": 127.0633,
  "radius": 500
}
```

#### Tests:
```javascript
pm.test("Status code is 200", function () {
    pm.response.to.have.status(200);
});

pm.test("Business district should have large marts and banks", function () {
    const jsonData = pm.response.json();
    const amenities = jsonData.convenience_score.amenity_details;
    
    const marts = amenities.find(a => a.category_code === 'MT1');
    const banks = amenities.find(a => a.category_code === 'BK9');
    
    console.log(`대형마트: ${marts ? marts.count : 0}개`);
    console.log(`은행: ${banks ? banks.count : 0}개`);
});
```

---

### 2-15. 왕십리역 인근 분석 (교통 환승 중심지)

### Method: POST
### URL: `{{base_url}}/api/location-analysis`

#### Headers:
```
Content-Type: application/json
Accept: */*
Origin: http://localhost:8185
```

#### Body (raw JSON):
```json
{
  "latitude": 37.5612,
  "longitude": 127.0377,
  "radius": 500
}
```

#### Tests:
```javascript
pm.test("Status code is 200", function () {
    pm.response.to.have.status(200);
});

pm.test("Transfer hub should have subway stations", function () {
    const jsonData = pm.response.json();
    const amenities = jsonData.convenience_score.amenity_details;
    
    const subway = amenities.find(a => a.category_code === 'SW8');
    
    console.log(`지하철역: ${subway ? subway.count : 0}개, 최단거리: ${subway ? subway.closest_distance : 'N/A'}m`);
});
```

---

### 2-16. 사당역 인근 분석 (주거/상업 복합)

### Method: POST
### URL: `{{base_url}}/api/location-analysis`

#### Headers:
```
Content-Type: application/json
Accept: */*
Origin: http://localhost:8185
```

#### Body (raw JSON):
```json
{
  "latitude": 37.4764,
  "longitude": 126.9814,
  "radius": 500
}
```

#### Tests:
```javascript
pm.test("Status code is 200", function () {
    pm.response.to.have.status(200);
});

pm.test("Residential-commercial area should have hospitals and pharmacies", function () {
    const jsonData = pm.response.json();
    const amenities = jsonData.convenience_score.amenity_details;
    
    const hospitals = amenities.find(a => a.category_code === 'HP8');
    const pharmacies = amenities.find(a => a.category_code === 'PM9');
    
    console.log(`병원: ${hospitals ? hospitals.count : 0}개`);
    console.log(`약국: ${pharmacies ? pharmacies.count : 0}개`);
});
```

---

### 2-17. 가산디지털단지역 인근 분석 (IT 산업단지)

### Method: POST
### URL: `{{base_url}}/api/location-analysis`

#### Headers:
```
Content-Type: application/json
Accept: */*
Origin: http://localhost:8185
```

#### Body (raw JSON):
```json
{
  "latitude": 37.4815,
  "longitude": 126.8826,
  "radius": 500
}
```

#### Tests:
```javascript
pm.test("Status code is 200", function () {
    pm.response.to.have.status(200);
});

pm.test("Industrial complex should have convenience stores and restaurants", function () {
    const jsonData = pm.response.json();
    const amenities = jsonData.convenience_score.amenity_details;
    
    const convenienceStores = amenities.find(a => a.category_code === 'CS2');
    const restaurants = amenities.find(a => a.category_code === 'FD6');
    
    console.log(`편의점: ${convenienceStores ? convenienceStores.count : 0}개`);
    console.log(`음식점: ${restaurants ? restaurants.count : 0}개`);
});
```

---

### 2-18. 영등포구청역 인근 분석 (행정/상업 복합)

### Method: POST
### URL: `{{base_url}}/api/location-analysis`

#### Headers:
```
Content-Type: application/json
Accept: */*
Origin: http://localhost:8185
```

#### Body (raw JSON):
```json
{
  "latitude": 37.5245,
  "longitude": 126.8960,
  "radius": 500
}
```

#### Tests:
```javascript
pm.test("Status code is 200", function () {
    pm.response.to.have.status(200);
});

pm.test("Administrative area should have public institutions", function () {
    const jsonData = pm.response.json();
    const amenities = jsonData.convenience_score.amenity_details;
    
    const publicInstitutions = amenities.find(a => a.category_code === 'PO3');
    
    console.log(`공공기관: ${publicInstitutions ? publicInstitutions.count : 0}개`);
});
```

---

### 2-19. 선릉역 인근 분석 (업무/상업 복합)

### Method: POST
### URL: `{{base_url}}/api/location-analysis`

#### Headers:
```
Content-Type: application/json
Accept: */*
Origin: http://localhost:8185
```

#### Body (raw JSON):
```json
{
  "latitude": 37.5048,
  "longitude": 127.0491,
  "radius": 500
}
```

#### Tests:
```javascript
pm.test("Status code is 200", function () {
    pm.response.to.have.status(200);
});

pm.test("Office-commercial area should have gas stations and parking", function () {
    const jsonData = pm.response.json();
    const amenities = jsonData.convenience_score.amenity_details;
    
    const gasStations = amenities.find(a => a.category_code === 'OL7');
    const parking = amenities.find(a => a.category_code === 'PK6');
    
    console.log(`주유소: ${gasStations ? gasStations.count : 0}개`);
    console.log(`주차장: ${parking ? parking.count : 0}개`);
});
```

---

### 2-20. 구로디지털단지역 인근 분석 (산업/IT 복합)

### Method: POST
### URL: `{{base_url}}/api/location-analysis`

#### Headers:
```
Content-Type: application/json
Accept: */*
Origin: http://localhost:8185
```

#### Body (raw JSON):
```json
{
  "latitude": 37.4854,
  "longitude": 126.9013,
  "radius": 500
}
```

#### Tests:
```javascript
pm.test("Status code is 200", function () {
    pm.response.to.have.status(200);
});

pm.test("IT-Industrial complex comprehensive analysis", function () {
    const jsonData = pm.response.json();
    
    console.log("=== 최종 분석 결과 ===");
    console.log(`주소: ${jsonData.address.road_address}`);
    console.log(`안전성 점수: ${jsonData.safety_score.total}`);
    console.log(`편의성 점수: ${jsonData.convenience_score.total}`);
    console.log(`종합 점수: ${jsonData.overall_score}`);
    console.log(`파출소 거리: ${jsonData.safety_score.police_distance}m`);
    console.log(`CCTV 개수: ${jsonData.safety_score.cctv_count}개`);
    console.log(`검거율: ${(jsonData.safety_score.arrest_rate * 100).toFixed(1)}%`);
    
    pm.expect(jsonData.overall_score).to.be.at.least(0);
    pm.expect(jsonData.overall_score).to.be.at.most(100);
});
```

---

## 3. 반경 변화 테스트

### 3-1. 최소 반경 테스트 (100m)

### Method: POST
### URL: `{{base_url}}/api/location-analysis`

#### Headers:
```
Content-Type: application/json
Accept: */*
Origin: http://localhost:8185
```

#### Body (raw JSON):
```json
{
  "latitude": 37.5665,
  "longitude": 126.9780,
  "radius": 100
}
```

#### Tests:
```javascript
pm.test("Status code is 200", function () {
    pm.response.to.have.status(200);
});

pm.test("Minimum radius (100m) should return fewer amenities", function () {
    const jsonData = pm.response.json();
    const amenities = jsonData.convenience_score.amenity_details;
    
    let totalCount = 0;
    amenities.forEach(a => {
        totalCount += a.count;
    });
    
    console.log(`100m 반경 내 총 편의시설: ${totalCount}개`);
});
```

---

### 3-2. 최대 반경 테스트 (2000m)

### Method: POST
### URL: `{{base_url}}/api/location-analysis`

#### Headers:
```
Content-Type: application/json
Accept: */*
Origin: http://localhost:8185
```

#### Body (raw JSON):
```json
{
  "latitude": 37.5665,
  "longitude": 126.9780,
  "radius": 2000
}
```

#### Tests:
```javascript
pm.test("Status code is 200", function () {
    pm.response.to.have.status(200);
});

pm.test("Maximum radius (2000m) should return more amenities", function () {
    const jsonData = pm.response.json();
    const amenities = jsonData.convenience_score.amenity_details;
    
    let totalCount = 0;
    amenities.forEach(a => {
        totalCount += a.count;
    });
    
    console.log(`2000m 반경 내 총 편의시설: ${totalCount}개`);
    pm.expect(totalCount).to.be.above(10);
});
```

---

## 4. 유효성 검증 테스트

### 4-1. 필수 필드 누락 테스트 (latitude 누락)

### Method: POST
### URL: `{{base_url}}/api/location-analysis`

#### Headers:
```
Content-Type: application/json
Accept: */*
Origin: http://localhost:8185
```

#### Body (raw JSON):
```json
{
  "longitude": 126.9780,
  "radius": 500
}
```

#### Tests:
```javascript
pm.test("Status code is 400", function () {
    pm.response.to.have.status(400);
});

pm.test("Error response for missing latitude", function () {
    const jsonData = pm.response.json();
    console.log("Error response:", JSON.stringify(jsonData, null, 2));
    
    const hasErrorInfo = jsonData.message || jsonData.error || jsonData.errors;
    pm.expect(hasErrorInfo).to.exist;
});
```

---

### 4-2. 필수 필드 누락 테스트 (longitude 누락)

### Method: POST
### URL: `{{base_url}}/api/location-analysis`

#### Headers:
```
Content-Type: application/json
Accept: */*
Origin: http://localhost:8185
```

#### Body (raw JSON):
```json
{
  "latitude": 37.5665,
  "radius": 500
}
```

#### Tests:
```javascript
pm.test("Status code is 400", function () {
    pm.response.to.have.status(400);
});

pm.test("Error response for missing longitude", function () {
    const jsonData = pm.response.json();
    console.log("Error response:", JSON.stringify(jsonData, null, 2));
    
    const hasErrorInfo = jsonData.message || jsonData.error || jsonData.errors;
    pm.expect(hasErrorInfo).to.exist;
});
```

---

### 4-3. 잘못된 위도 범위 테스트 (위도 > 90)

### Method: POST
### URL: `{{base_url}}/api/location-analysis`

#### Headers:
```
Content-Type: application/json
Accept: */*
Origin: http://localhost:8185
```

#### Body (raw JSON):
```json
{
  "latitude": 95.0,
  "longitude": 126.9780,
  "radius": 500
}
```

#### Tests:
```javascript
pm.test("Status code is 400", function () {
    pm.response.to.have.status(400);
});

pm.test("Validation error for invalid latitude", function () {
    const jsonData = pm.response.json();
    console.log("Error response:", JSON.stringify(jsonData, null, 2));
});
```

---

### 4-4. 잘못된 경도 범위 테스트 (경도 < -180)

### Method: POST
### URL: `{{base_url}}/api/location-analysis`

#### Headers:
```
Content-Type: application/json
Accept: */*
Origin: http://localhost:8185
```

#### Body (raw JSON):
```json
{
  "latitude": 37.5665,
  "longitude": -185.0,
  "radius": 500
}
```

#### Tests:
```javascript
pm.test("Status code is 400", function () {
    pm.response.to.have.status(400);
});

pm.test("Validation error for invalid longitude", function () {
    const jsonData = pm.response.json();
    console.log("Error response:", JSON.stringify(jsonData, null, 2));
});
```

---

### 4-5. 잘못된 반경 범위 테스트 (반경 < 100)

### Method: POST
### URL: `{{base_url}}/api/location-analysis`

#### Headers:
```
Content-Type: application/json
Accept: */*
Origin: http://localhost:8185
```

#### Body (raw JSON):
```json
{
  "latitude": 37.5665,
  "longitude": 126.9780,
  "radius": 50
}
```

#### Tests:
```javascript
pm.test("Status code is 400", function () {
    pm.response.to.have.status(400);
});

pm.test("Validation error for radius below minimum", function () {
    const jsonData = pm.response.json();
    console.log("Error response:", JSON.stringify(jsonData, null, 2));
});
```

---

### 4-6. 잘못된 반경 범위 테스트 (반경 > 2000)

### Method: POST
### URL: `{{base_url}}/api/location-analysis`

#### Headers:
```
Content-Type: application/json
Accept: */*
Origin: http://localhost:8185
```

#### Body (raw JSON):
```json
{
  "latitude": 37.5665,
  "longitude": 126.9780,
  "radius": 3000
}
```

#### Tests:
```javascript
pm.test("Status code is 400", function () {
    pm.response.to.have.status(400);
});

pm.test("Validation error for radius above maximum", function () {
    const jsonData = pm.response.json();
    console.log("Error response:", JSON.stringify(jsonData, null, 2));
});
```

---

## 5. Collection-level Pre-request Script

```javascript
// 공통 변수 설정
pm.globals.set("timestamp", new Date().toISOString());
console.log("Request started at: " + pm.globals.get("timestamp"));

// Redis 및 Oracle 연결 상태 확인 (선택사항)
pm.globals.set("redis_host", "127.0.0.1:6379");
pm.globals.set("oracle_host", "localhost:1521");

// 테스트 실행 카운터
const currentCount = pm.globals.get("test_count") || 0;
pm.globals.set("test_count", currentCount + 1);
console.log(`Test execution count: ${currentCount + 1}`);
```

---

## 6. Collection-level Test Script

```javascript
// 응답 시간 로깅
const responseTime = pm.response.responseTime;
console.log(`Response time: ${responseTime}ms`);

// 성능 기준 체크
if (responseTime > 2000) {
    console.warn(`⚠️ Slow response detected: ${responseTime}ms (Target: < 500ms)`);
} else if (responseTime > 500) {
    console.log(`⚡ Response time acceptable: ${responseTime}ms (Target: < 500ms)`);
} else {
    console.log(`✅ Excellent response time: ${responseTime}ms`);
}

// 전역 통계 수집
const totalTests = pm.globals.get("total_tests") || 0;
const passedTests = pm.globals.get("passed_tests") || 0;

pm.globals.set("total_tests", totalTests + 1);
if (pm.response.code === 200) {
    pm.globals.set("passed_tests", passedTests + 1);
}
```

---

## 7. 예상 응답 구조 (Mixed Naming)

```json
{
  "analysis_status": "SUCCESS",
  "coordinate": {
    "latitude": 37.5665,
    "longitude": 126.9780
  },
  "address": {
    "road_address": "서울특별시 중구 세종대로 110",
    "jibun_address": "서울특별시 중구 태평로1가 31"
  },
  "safety_score": {
    "total": 75,
    "police_distance": 250,
    "cctv_count": 15,
    "cctv_list": [
      {
        "address": "세종대로 99",
        "latitude": 37.5670,
        "longitude": 126.9785,
        "camera_count": 2
      }
    ],
    "arrest_rate": 0.85,
    "nearest_police_office": {
      "address": "서울특별시 중구 세종대로 99",
      "latitude": 37.5668,
      "longitude": 126.9781,
      "distance": 250
    }
  },
  "convenience_score": {
    "total": 82,
    "amenity_details": [
      {
        "category_code": "SW8",
        "category_name": "지하철역",
        "count": 2,
        "closest_distance": 120,
        "places": [
          {
            "name": "시청역",
            "latitude": 37.5663,
            "longitude": 126.9773,
            "distance": 120
          }
        ]
      }
    ]
  },
  "overall_score": 78,
  "recommendations": [
    "안전 인프라가 잘 갖춰진 지역입니다.",
    "대중교통 접근성이 우수합니다."
  ],
  "warnings": [
    "야간 시간대에는 주의가 필요합니다."
  ]
}
```

---

## 8. 성능 목표 및 검증

### 성능 목표 (Performance Target)

| 지표 | 목표치 | 측정 방법 |
|------|--------|----------|
| 평균 응답 시간 | 500ms 이하 | 전체 요청의 산술 평균 |
| 95th Percentile | 1,000ms 이하 | 상위 5% 제외한 최대값 |
| 처리량 (TPS) | 50 이상 | 초당 처리 가능한 요청 수 |
| 에러율 | 0.1% 미만 | (실패 요청 / 전체 요청) × 100 |

### 검증 방법

**JMeter 통합:**
- 이 Postman 컬렉션을 JMeter로 변환하여 부하 테스트 수행
- Thread Group 설정으로 동시 사용자 시뮬레이션
- Summary Report로 성능 지표 측정

**로그 분석:**
- 애플리케이션 성능 로그(`performance.log`)에서 R-01 ~ R-07 단계별 시간 분석
- Python/Pandas를 사용한 병목 구간 식별

---

## 9. 테스트 실행 순서

### 권장 실행 순서:

1. **기본 검증 (1번)**
   - Health Check

2. **정상 시나리오 (2-1 ~ 2-20번)**
   - 20개 좌표 순차 실행
   - 각 지역 특성에 맞는 결과 확인

3. **반경 변화 테스트 (3-1 ~ 3-2번)**
   - 최소/최대 반경으로 동작 확인

4. **유효성 검증 (4-1 ~ 4-6번)**
   - 잘못된 입력에 대한 에러 처리 확인

### 전체 실행:
- Postman Collection Runner 사용
- 순차 실행으로 Redis 캐시 효과 확인
- 각 요청 간 0.5초 간격 설정 권장

---

## 10. 문서 버전 관리

| 버전 | 날짜 | 작성자 | 변경 내역 |
|------|------|--------|----------|
| 1.0 | 2025-01-23 | 정범진 | 초안 작성 - 20개 좌표 기반 위치 분석 API 테스트 명세서 |
| 1.1 | 2025-01-23 | 정범진 | 실제 요청 분석 기반 수정 - 포트 8185 변경, Accept 헤더 제거 |
| 1.2 | 2025-01-23 | 정범진 | 필수 헤더 추가 - Accept: */*, Origin: http://localhost:8185 |
| 1.3 | 2025-01-23 | 정범진 | 구조 개선 - 파출소 조회 API 제거, 전체 섹션 번호 재정렬 |

---

**문서 종료**