# 부동산 추천 시스템 '안전성 점수' 아키텍처 설계서

**버전**: 1.0  
**작성일**: 2025.08.21  
**상태**: 아키텍처 설계 완료, 기술 검증(PoC) 진행 필요

---

## 1. 프로젝트 개요

### 1.1 문제 정의
**초기 상태**: 기존 포트폴리오의 추천 시스템은 실제 비즈니스 로직이 부재한 정적 데이터 정렬 기능에 머물러 있음

**프로젝트 목표**: 사용자가 실제로 중요하게 생각하는 '안전성'을 중심으로, **1인 가구**를 위한 유의미하고 동적인 주거지 추천 로직을 설계하고 구현

### 1.2 핵심 타겟
- **대상**: 1인 가구
- **중점 요소**: 체감 안전성
- **접근 방식**: 데이터 기반 객관적 안전성 평가

---

## 2. 문제 심화 분석 및 기술적 난관

### 2.1 사용자 체감 안전의 실제 기준
사용자가 실제로 체감하는 안전은 다음과 같은 구체적 기준에 의해 결정됨:
- **아파트/빌라별 거주지 기준**: 개별 주거 단위의 환경적 특성
- **지역구 범용적 수치**: 광역적 치안 수준
- **주변 상가/환경 기준**: 반경 500m 내 시설물과 공터 등의 요소

### 2.2 이상적 모델과 현실적 제약
**이상적 접근**: 특정 주거지 좌표를 기준으로 주변 반경 내 시설물별 범죄 횟수 및 검거율 분석
- KAKAO MAP API로 좌표 획득 가능
- 반경 미터 크기 제한 수식 도출 필요
- 시설물 기점별 범죄 발생 통계 및 시설물 유형별 위험도 분류

**현실적 한계**: 구 단위 통계의 한계성
- 강서구, 영등포구 등 광역 단위 산출은 통계적 의미 부족
- 동별 발생율/검거율도 여전히 체감 안전과 거리 존재

### 2.3 핵심 난관: '체감 안전'과 '통계 데이터'의 간극

초기 설계는 공공데이터(범죄율, CCTV 등)를 조합하여 안전 점수를 산출하는 방향으로 시작되었으나, 기술 검증(PoC) 및 데이터 심층 분석 과정에서 근본적인 한계에 도달:

#### 2.3.1 데이터 입도(Granularity) 불일치
- **사용자 체감 안전**: 집 주변 500m 반경과 같은 **초지역적(Hyper-local)** 수준
- **확보 가능한 데이터**: **경찰서 관할 단위 혹은 구 단위**로 집계된 **거시적(Macro)** 통계

#### 2.3.2 이상적 데이터의 부재
- 'A 아파트' 또는 'B 상가'와 같이 특정 좌표나 건물 단위로 발생한 범죄 통계는 개인정보보호 및 수사 기밀 등의 사유로 공공데이터로 제공되지 않음

#### 2.3.3 결론 및 데이터 재수집 시도
사용자가 원하는 수준의 '초지역적 안전도'를 데이터로 직접 계산하는 것은 **불가능**

**데이터 재수집 가능성 탐색**:
- **공공데이터포털**: 경찰서 관할 단위 혹은 구 단위 공개가 한계로, 이것이 공식적으로 제공되는 가장 세분화된 범죄 통계
- **생활안전지도**: 행정안전부의 시각화 서비스이나 개발자용 원본 데이터 API 미제공
- **민간 데이터**: 보안업체/부동산 분석기업의 상업적 데이터는 비용 및 접근성 제약
- **최종 결론**: 이상적인 데이터는 존재하지 않으므로, 보유 데이터를 최대한 정교하게 활용하는 Proxy 모델이 최선

### 2.4 해결 전략: Proxy 모델 기반 하이브리드 접근
**핵심 철학**: 간접적인 데이터로 실제 안전 요인을 '추론(Proxy)'하는 하이브리드 모델 아키텍처 채택

> 거시적 데이터로 객관적인 지역 순위를 정하고, 미시적 데이터로 개별 주거지의 체감 위험도를 보정한다.

---

## 3. 학술적 근거: 지역 안전 지수 설계 프레임워크

### 3.1 CPTED 이론 기반 접근
기존 연구에서 널리 사용되는 지역 안전 지수(Community Safety Index) 구축 방법론을 적용하여 객관적 근거 확보

#### 3.1.1 환경설계를 통한 범죄예방(CPTED) 이론
**핵심 개념**: 범죄에 영향을 미치는 환경적 요인들을 종합적으로 고려

**지표 분류**:
- **공식적 감시(Formal Surveillance)**: 공권력에 의한 직접적 감시 수준
- **환경적 위험 요인(Environmental Risk Factors)**: 범죄 발생 가능성을 높이는 물리적 환경
- **사회적 무질서(Social Disorder)**: 지역의 관리 수준을 보여주는 간접 지표
- **실제 범죄 발생률(Crime Rate)**: 객관적 범죄 통계

### 3.2 1인 가구 맞춤형 안전성 지표 설계

#### 3.2.1 야간 보행 안전 (Nighttime Walking Safety)
**측정 목표**: "늦은 밤, 지하철역에서 집까지 걸어가는 길이 안전한가?"

| 측정 지표 | 데이터 소스 | 안전도 기여 |
|:---|:---|:---|
| 유흥업소 밀도 | KAKAO MAP API | 낮을수록 안전 (Negative) |
| 가로등 밀도 | 공공데이터포털 (지자체별) | 높을수록 안전 (Positive) |
| 대로변과의 거리 | KAKAO MAP API | 가까울수록 안전 (Positive) |
| 24시간 편의점/가게 수 | KAKAO MAP API | 많을수록 안전 (Positive) |

#### 3.2.2 주거 침입 안전 (Home Invasion Safety)
**측정 목표**: "내가 사는 집 자체가 외부 위협으로부터 안전한가?"

| 측정 지표 | 데이터 소스 | 안전도 기여 |
|:---|:---|:---|
| 건물 유형 | 국토교통부 API | 아파트 > 오피스텔 > 빌라 순 |
| 지역 내 CCTV 밀도 | 공공데이터포털 | 높을수록 안전 (Positive) |
| 저층(1~3층) 여부 | 국토교통부 API | 저층이 아닐수록 안전 |

#### 3.2.3 범죄 노출도 (General Crime Exposure)
**측정 목표**: "이 지역의 전반적인 범죄 위험 수준은 어떠한가?"

| 측정 지표 | 데이터 소스 | 안전도 기여 |
|:---|:---|:---|
| 성범죄/강도 발생률 | 경찰청 통계 | 낮을수록 안전 (Negative) |
| 절도 발생률 | 경찰청 통계 | 낮을수록 안전 (Negative) |
| 파출소/지구대와의 거리 | KAKAO MAP API | 가까울수록 안전 (Positive) |

---

## 4. 최종 아키텍처: 2단계 레이어 모델

### 4.1 Layer 1: 거시적 안전도 (Macro-Safety Score)

**목표**: 지역(구)의 전반적인 치안 수준을 나타내는 기본 점수(Baseline Score) 산출

**사용 데이터**: 경찰서별 혹은 구별 5대범죄 발생 현황 데이터

**산출 방식**: 
- 31개 경찰서 데이터를 25개 자치구와 매핑 (경찰서 관할 단위 혹은 구 단위 기준)
- 인구수 대비 범죄 발생률을 정규화
- 0~100점 사이의 점수로 변환

### 4.2 Layer 2: 미시적 위험도 (Micro-Risk Modifier)

**목표**: 개별 주거지(좌표) 주변 환경을 분석하여 기본 점수를 보정하는 가감점(Modifier) 산출

**사용 데이터**: 
- KAKAO MAP API
- 지자체별 공공데이터
- 장소별 5대범죄 발생 현황 데이터

#### 4.2.1 핵심 지표 (1인 가구 맞춤)

**야간 보행 안전**:
- 유흥업소 밀도 (감점 요인)
- 가로등 밀도 (가점 요인)
- 24시간 편의점 수 (가점 요인)
- 대로변과의 거리 (가점 요인)

**주거 침입 안전**:
- CCTV 밀도 (가점 요인)
- 파출소/지구대와의 거리 (가점 요인)
- 저층(1~3층) 여부 (감점 요인)

---

## 5. 점수 산출 방법론

### 5.1 AHP 기법 기반 4단계 체계적 프로세스

#### 5.1.1 지표 선정
앞서 명시된 '거시' 및 '미시' 지표들을 최종 측정 항목으로 확정

#### 5.1.2 데이터 정규화 (Normalization)
- **방식**: Min-Max 정규화
- **적용**: 모든 지표(CCTV 개수, 유흥업소까지의 거리 등)를 0~1 사이의 공통된 척도로 변환

#### 5.1.3 가중치 부여 (Weighting)
- **기준**: 1인 가구의 특성 고려
- **방법론**: AHP(Analytic Hierarchy Process) 기법을 간소화하여 서비스 핵심 타겟 유저에게 가장 중요한 요소에 높은 가중치 부여
- **예시**: 야간 보행 안전(40%) 등 체감 안전에 중요한 영향을 미치는 요소에 더 높은 가중치 부여
- **정책**: 가설 기반의 정책 수립

**가중치 설정 가설**:
- **야간 보행 안전**: 40% (1인 가구 여성의 주요 관심사)
- **주거 침입 안전**: 30% (직접적 위험 요소)
- **범죄 노출도**: 30% (객관적 지역 안전도)

#### 5.1.4 지수 산출 (Aggregation)
**모델**: 선형 가중 합산 모델 (Linear Weighted Sum Model)

```
최종 점수 = (거시 점수) - (위험 인자 가중합) + (안전 인자 가중합)
```

**세부 산출식**:
```
최종 안전 점수 = (야간 보행 점수 × 0.4) + (주거 침입 점수 × 0.3) + (범죄 노출도 점수 × 0.3)
```

---

## 6. 시설물별 안전성 지표 정의

### 6.1 정책 수립 필요성
시스템의 현실적인 제약(성능, 비용, 안정성)을 고려하여 단순한 기획을 넘어 실제 동작하는 시스템을 구축하는 아키텍트 관점으로 전환

### 6.2 Facility Safety Score 테이블
장소별 5대범죄 발생 현황 데이터를 근거로 한 가설 기반 정책

| 시설물 카테고리 (KAKAO API 기준) | 안전성 기여도 (Score) | 근거 |
|:---|:---:|:---|
| **SW8** (지하철역) | +0.5 | 24시간 유동인구, 공식적 감시 |
| **CS2** (편의점) | +0.2 | 24시간 운영, 비공식적 감시 |
| **PO3** (파출소, 지구대) | +3.0 | 직접적인 치안 유지 기능 |
| **FD6** (음식점) / **CE7** (카페) | 0.0 | 중립 |
| **AT4** (관광/숙박) / **AD5** (숙박) | -1.0 | 익명성, 외부인 유입 |
| **HP8** (병원) | +1.0 | 필수 공공시설, 야간 운영 |
| **PS3** (유치원) / **SC4** (학교) | +1.5 | 아동 보호 구역 |
| **PK6** (주차장) / 공터 | -0.5 | 감시 취약, CPTED상 위험지역 |
| **유흥업소** (주점/노래방) | -2.0 | 장소별 데이터상 높은 폭력 발생률 |

**📝 선행 과제**: 위 정책 테이블 확정이 모든 계산의 전제 조건

---

## 7. 시스템 아키텍처 설계: 실시간 vs 배치

### 7.1 아키텍처 비교 분석

#### 7.1.1 계획 1: 실시간 동적 분석 모델 (비권장)

**동작 흐름**:
1. 사용자 요청 발생 → 매물 좌표 획득
2. KAKAO MAP API 호출 (좌표 반경 500m 내 시설물 검색)
3. 반환된 시설물 목록과 Facility Safety Score 테이블 매칭하여 '미시적 위험도' 실시간 계산
4. '거시적 안전도'와 결합하여 최종 점수 반환

**치명적 문제점**:
- **성능**: 사용자 요청마다 외부 API 호출로 응답 시간 최소 수 초 이상 소요, 사용자 경험 극도로 저하
- **비용**: 사용자가 스크롤하며 수십 개의 매물을 보는 순간마다 API 호출, API 이용료 기하급수적 증가, AWS 리소스 비용 동반 상승
- **안정성**: KAKAO MAP API의 일시적 장애나 속도 저하가 서비스 전체 장애로 직결되는 매우 취약한 구조

#### 7.1.2 계획 2: 배치 기반 사전 처리 모델 (최종 권장 아키텍처)

**핵심 개념**: 사용자 요청 시점과 데이터 수집/계산 시점을 완전히 분리
**특징**: 성능, 비용, 안정성을 모두 만족시키는 현실적 절충안

### 7.2 최종 아키텍처 구성

#### 7.2.1 A. 오프라인 배치 시스템 (Offline Batch System)

**실행 주기**: Spring @Scheduled 등을 이용해 매일 새벽 또는 주 1회 등 주기적으로 실행

**동작 흐름**:
1. 서울시 전체를 일정한 크기의 격자(Grid, 예: 100m x 100m)로 분할
2. 각 격자의 중심 좌표를 기준으로 KAKAO MAP API를 단 한 번 호출하여 주변 시설물 정보 수집
3. 수집된 시설물 정보와 Facility Safety Score를 이용해 해당 격자의 '미시적 위험도' 점수를 미리 계산
4. 계산된 결과를 격자 ID - 위험도 점수 형태로 Redis나 DB에 저장

#### 7.2.2 B. 온라인 추천 시스템 (Online Recommendation System)

**동작 흐름**:
1. 사용자 요청 발생 → 매물 좌표 획득
2. 해당 좌표가 속한 격자 ID를 계산 (간단한 좌표 변환 로직)
3. Redis/DB에서 해당 격자 ID의 미리 계산된 '미시적 위험도' 점수를 조회 (수십 밀리초 내외로 매우 빠름)
4. '거시적 안전도'와 결합하여 최종 점수를 즉시 반환

---

## 8. 데이터 소스 및 기술 스택

### 8.1 주요 데이터 소스
- **KAKAO MAP API**: '카테고리로 장소 검색' 기능
  - **파라미터**: (x, y, radius, category_group_code)
  - **기능**: 특정 좌표 반경 내의 특정 카테고리(편의점, 은행 등) 시설물 목록과 개수 조회
- **경찰청 통계**: 경찰서 관할 단위 혹은 구 단위로 집계된 5대범죄 발생 현황 데이터
- **지자체별 공공데이터** (CCTV, 가로등 등)

### 8.2 기술적 고려사항
**격자 크기 결정**: 트레이드오프 존재
- **100m x 100m**: 정밀하지만 계산량 많음
- **250m x 250m**: 계산량은 적지만 정밀도 낮음

### 8.3 아키텍처 채택 근거
**최종 결론**: 계획 2(배치 기반 사전 처리 모델) 채택
- **초기 개발 복잡도**: 약간 높음
- **장기적 우위**: 서비스 안정성과 비용 효율성 측면에서 비교할 수 없는 우위

---

## 9. 실행 계획

### 9.1 가장 시급한 과제
제안된 아키텍처의 기술적 실현 가능성 검증

### 9.2 우선순위별 기술 검증 계획

#### 9.2.1 1순위 과제
공공데이터포털에서 '가로등 설치 정보' API 또는 데이터셋 확보 가능성 확인

#### 9.2.2 2순위 과제
KAKAO MAP API의 '키워드로 장소 검색' 기능을 사용하여 특정 좌표 반경 내 '유흥주점', '24시간 편의점' 등의 개수를 정확히 카운트하는 기술 검증(PoC) 수행

### 9.3 구체적 행동 계획
KAKAO MAP API를 사용하여 다음 항목들의 기술 검증(PoC) 코드를 우선적으로 작성:
- 특정 좌표 반경 내 '유흥주점', '24시간 편의점' 등의 개수 정확 카운트
- '파출소', '대로변'까지의 거리 계산

### 9.4 선행 결정 사항
1. **Facility Safety Score 정책 테이블 확정**
2. **서울시를 나눌 격자(Grid) 크기 결정**
   - 예시: 100m x 100m vs 250m x 250m 트레이드오프 고려

### 9.5 다음 단계
상기 두 가지 결정을 바탕으로 단일 격자에 대한 '미시적 위험도'를 계산하는 배치 작업 PoC 코드 작성

---

## 10. 결론

본 아키텍처는 **배치 기반 사전 처리 모델**을 최종 권장안으로 채택함으로써:

- **성능**: 실시간 응답 보장 (수십 밀리초 내외)
- **비용**: API 호출 최적화를 통한 운영비용 절약
- **안정성**: 외부 API 의존성 최소화를 통한 서비스 안정성 확보

시스템의 현실적 제약사항을 모두 고려한 실제 동작 가능한 아키텍처로서, 단순한 기획을 넘어 아키텍트 관점에서 설계된 현실적이고 실용적인 솔루션임.

---

## 11. '단순 검거율' 지표의 근본적 한계

안전성 평가 시스템 설계에서 '단순 검거율'을 안전의 척도로 삼는 것은 근본적인 한계가 있다. 이는 실제 현상을 바탕으로 모델의 타당성을 비판적으로 검토한 결과이다.

### 사후 지표 vs 사전 지표의 근본적 차이

'검거율'은 사건이 이미 발생한 후의 경찰의 대응 능력을 측정하는 '사후(Reactive)' 지표이다. 반면, 주민이 느끼는 '체감 안전'은 사건이 애초에 발생하지 않을 것이라는 기대감을 나타내는 '사전(Proactive)' 지표이다. 이 둘은 측정하는 대상 자체가 근본적으로 다르다.

### 논리적 모순의 구체적 사례

살인죄를 예로 들면, 살인죄의 검거율은 통상 90%를 넘지만, 그렇다고 해서 살인사건이 많이 발생하는 지역을 '안전하다'고 말할 수는 없다. 오히려 검거율이 높다는 것은 그만큼 심각한 범죄가 자주 발생하여 경찰의 대응이 많았다는 의미일 수 있다.

### 통계적 왜곡 문제

빅데이터 분석 보고서(4조_2팀_빅데이터분석결과보고서_v0.1.docx)에서도 이와 유사한 결론을 내리고 있다. 보고서는 "단순 범죄율만으로는 지역의 특성을 완벽히 설명할 수 없으며", "범죄 발생에 영향을 미치는 다른 사회경제적 요인들을 함께 고려해야 한다"고 명시하고 있다. 이는 '검거율'이라는 단일 지표가 아닌, 범죄가 발생하는 '환경' 자체를 분석해야 한다는 점을 뒷받침한다.

## 12. Proxy 모델의 설계 우수성

### 환경적 요인 중심의 사전 예방 접근

현재 설계된 'Proxy 모델'은 '검거율'과 같은 사후 지표를 배제하고, '체감 안전'에 직접적으로 영향을 미치는 사전적, 환경적 요인에 집중한다. 이러한 문제 때문에 'Proxy 모델'은 범죄가 발생하기 어려운 환경인지를 측정하는 방식을 택했다.

### 빅데이터 분석 결과의 뒷받침

빅데이터 분석 보고서는 "CCTV 설치 대수와 같은 물리적 환경 요소가 범죄율과 유의미한 관계를 보였다"고 분석하며, "경찰서와의 거리 또한 치안 서비스 접근성에 영향을 미치는 중요한 변수"임을 시사한다. 이는 선정한 핵심 지표들이 왜 타당한지에 대한 강력한 근거가 된다.

### 핵심 지표의 체계적 분류

**공식적 감시 요소**
- CCTV 밀도, 파출소와의 거리: 보고서가 언급한 대로, 범죄를 사전에 억제하는 '공식적 감시' 기능에 해당한다.

**자연적 감시 요소**
- 가로등 밀도, 24시간 편의점 수: 범죄 심리를 위축시키는 '자연적 감시' 역할을 한다.

**위험 요인 측정**
- 유흥업소 밀도: 범죄 발생 가능성이 높은 환경적 위험 요인을 측정한다.

### 사용자 요구에 부합하는 가치 제공

결론적으로, '검거율'을 사용하는 것은 이미 벌어진 범죄의 뒷수습을 보는 것이고, Proxy 모델은 범죄가 발생하기 어려운 환경인지를 측정하는 것이다. 1인 가구 주민이 원하는 것은 '범인이 잘 잡히는 동네'가 아니라 '범죄가 잘 일어나지 않는 동네'이므로, 현재 아키텍처 방향이 사용자의 요구에 훨씬 더 부합한다.

## 13. 데이터 기반 가중치 설정 방법론

### 상관관계 기반 가중치 설정의 합리성

인구 규모당 전체 범죄율을 계산하여 가장 높은 범죄율 지역과 가장 낮은 범죄율 지역을 Java 기술을 사용해서 수치화한 다음, 연관되는 가장 높은 범죄율이 발생하는 종속변수에 그만큼 가중치를 두는 접근법은 매우 합리적이고 통계적인 방법이다. 이는 주관적인 판단에서 벗어나 데이터 스스로가 중요도를 말하게 하려는 시도로서, 아키텍처의 객관성과 설득력을 크게 높인다.

### 상관관계 분석의 핵심 원리

이 아이디어의 핵심은 "범죄율이 높은 지역에서 공통적으로 나타나는 환경적 특성을 찾아내고, 그 특성에 높은 가중치를 부여하자"는 것이다. 이는 통계학에서 상관관계 분석(Correlation Analysis)을 통해 변수의 중요도를 파악하는 방식과 정확히 일치한다.

### 구체적인 실행 프레임워크

**1단계: 분석용 데이터셋 구축 (Dataset Construction)**

상관관계를 분석할 수 있는 형태의 단일 데이터 테이블을 만들어야 한다.

구조:
- 행(Row): 서울시 25개 자치구 (또는 더 세분화된 지역 단위)
- 열(Column):
  - 인구수
  - 총범죄발생건수
  - 인구대비_범죄율 (종속변수)
  - CCTV_밀도 (독립변수 1)
  - 유흥업소_수 (독립변수 2)
  - 파출소_거리 (독립변수 3)
  - 공원_면적 (독립변수 4)
  - ... 등 수집한 모든 환경 변수

**2단계: 상관관계 분석 (Correlation Analysis)**

각 '환경 변수(독립변수)'가 '인구대비 범죄율(종속변수)'과 얼마나 강한 관계를 갖는지 통계적으로 계산한다.

방법: 피어슨 상관 계수(Pearson Correlation Coefficient)를 계산한다. 이 계수는 -1부터 1 사이의 값을 가지며, 1이나 -1에 가까울수록 강한 관계를 의미한다.

기술 구현: Apache Commons Math 라이브러리의 PearsonsCorrelation 클래스를 사용하여 Java로 직접 구현할 수 있다.

**3단계: 가중치 설정 (Weight Setting)**

분석 결과를 바탕으로 가중치를 할당한다.

규칙: 상관 계수의 절댓값이 높게 나타난 환경 변수일수록, '범죄율'에 더 큰 영향을 미치는 중요한 변수라고 '가설'을 세우고, 더 높은 가중치를 부여한다.

예시: 만약 '유흥업소 수'의 상관 계수가 +0.7이고 'CCTV 밀도'의 상관 계수가 -0.6이라면, '유흥업소 수'가 CCTV보다 범죄율에 더 큰 영향을 미치는 변수라고 판단하여 더 높은 가중치를 할당할 수 있다.

## 14. 상관관계와 인과관계의 구분

### 통계 분석의 중요한 함정

상관관계는 인과관계가 아니다. 예를 들어 '편의점 수'와 '범죄율'이 높은 상관관계를 보일 수 있다. 이는 '편의점이 범죄를 유발한다'는 인과관계를 의미하는 것이 아니라, '유동인구가 많은 상업지역에 편의점과 범죄가 모두 집중된다'는 제3의 요인 때문일 수 있다.

### 아키텍처적 접근 방식

따라서, 이 통계적 분석 결과는 **'절대적인 진리'가 아닌, 가중치에 대한 '가장 합리적인 초기 가설'**로 사용해야 한다. "데이터 분석 결과, 이러한 변수들이 범죄율과 높은 관련성을 보여, 이를 바탕으로 가중치를 설정했다"고 명시하는 것만으로도 이전의 주관적 판단과는 차원이 다른 설득력을 갖게 된다.

## 15. 통계적 근거의 본질과 한계

### 객관적 근거 마련의 필요성

가중치 설정에 있어 정확한 수치적 근거를 개별적으로 찾기 어려운 상황에서, 통계적 분석을 통해 객관적이고 방어 가능한 근거를 마련하고자 한다. 이는 주관적 판단의 한계를 보완하기 위한 방법론적 접근이다.

상관관계 분석을 통해 얻는 '근거'의 본질은 다음과 같다:

**객관성 (Objectivity)**
'검거율'이나 개인적인 직감에 의존하는 것보다, 실제 데이터의 패턴을 기반으로 하므로 훨씬 객관적이다. "A라는 변수가 B라는 결과와 통계적으로 높은 관련이 있음을 확인했다"는 사실은 누구도 부정할 수 없는 객관적인 출발점이다.

**투명성 (Transparency)**
가중치를 설정한 이유를 명확하게 설명할 수 있다. "시스템은 유흥업소 수에 높은 위험 가중치를 부여한다. 왜냐하면, 실제 데이터 분석 결과 범죄율과 가장 높은 양의 상관관계를 보였기 때문이다."와 같이 설계 결정의 모든 과정을 추적하고 방어할 수 있다.

**개선 가능성 (Iterability)**
이 모델은 완벽하지 않기에 오히려 더 강력하다. 만약 서비스 운영 후 사용자의 피드백이나 새로운 데이터가 가설과 다르다는 것을 보여준다면, 언제든지 데이터를 다시 분석하여 가중치를 합리적으로 수정하고 시스템을 개선할 수 있다.

**결론**
개별 환경 변수에 대한 정확한 가중치를 직관적으로 판단하기 어려운 상황에서, **'데이터에 기반하여 투명하게 수립된, 지속적으로 개선 가능한 통계적 근거'**를 확보하는 것이 핵심 목표이다. 이를 통해 주관적 설계를 넘어선 공학적 설계 방법론을 구축할 수 있다.

## 16. 피어슨 상관계수 기반 가중치 산정 명세

### 상관계수 정의 및 범위

피어슨 상관계수는 두 변수 간의 선형 관계의 강도와 방향을 측정하는 통계적 지표이다.

**수치 범위**: -1 ≤ r ≤ +1
- r = +1: 완전한 양의 선형 관계
- r = 0: 선형 관계 없음
- r = -1: 완전한 음의 선형 관계

### 기술적 구현 방식

**라이브러리**: Apache Commons Math의 PearsonsCorrelation 클래스
**입력 데이터**: 인구대비 범죄율(종속변수)과 각 환경변수(독립변수) 간의 페어링된 데이터셋
**출력**: 각 환경변수별 상관계수 값(-1~+1)

## 17. 가중치 산정 알고리즘 명세

### 상관계수 분해 원칙

상관계수 r은 두 개의 독립적 정보를 포함한다:
- **방향성**: sign(r) ∈ {-1, +1}
- **영향력 강도**: |r| ∈ [0, 1]

### 가중치 산정 공식

**기본 원칙**: 가중치 = f(|r|)
- 가중치는 상관계수의 절댓값에 정비례한다
- 방향성(부호)은 점수 계산 시 적용하며, 가중치 자체에는 반영하지 않는다

**구체적 산정 방식**:
```
Weight_i = |r_i| × 100  (백분율 가중치)
또는
Weight_i = |r_i|^α × K  (비선형 변환, α는 조정 파라미터, K는 스케일링 상수)
```

### 방향성 기반 점수 적용 규칙

| 상관계수 부호 | 범죄율과의 관계 | 점수 적용 방식 |
|--------------|----------------|---------------|
| r > 0 | 정비례 관계 (위험 요인) | 감점 처리 |
| r < 0 | 반비례 관계 (안전 요인) | 가점 처리 |
| r ≈ 0 | 무관 | 점수 반영 제외 |

## 18. 안전성 점수 계산 알고리즘

### 이중 판정 체계

안전성 점수 계산을 위해 각 환경 변수에 대해 두 가지 판정을 수행한다:

**판정 1: 영향력 강도 측정**
- 목적: 가중치 크기 결정
- 방법: |상관계수| 값을 기준으로 중요도 순위 매김
- 임계값: |r| ≥ 0.3 (통계적 유의성 기준선)

**판정 2: 안전성 방향 판정**
- 목적: 가점/감점 여부 결정
- 방법: 상관계수 부호 확인
- 규칙:
  - r > 0 → 위험 요인 → 감점 적용
  - r < 0 → 안전 요인 → 가점 적용

### 점수 계산 공식

```
최종점수 = Σ(정규화된_환경변수값_i × Weight_i × Direction_i)

where:
- Weight_i = |r_i| × 스케일링_팩터
- Direction_i = sign(r_i) ∈ {-1, +1}
- 정규화된_환경변수값_i ∈ [0, 1]
```

### 변수별 처리 예시

| 환경 변수 | 상관계수 | 절댓값 | 가중치 | 방향 | 최종 처리 |
|-----------|----------|----------|--------|------|-----------|
| 유흥업소 밀도 | +0.7 | 0.7 | 높음 | 위험(+) | 높은 가중치로 감점 |
| CCTV 밀도 | -0.6 | 0.6 | 중간 | 안전(-) | 중간 가중치로 가점 |
| 공원 면적 | -0.1 | 0.1 | 낮음 | 안전(-) | 낮은 가중치로 가점 |

## 19. 시스템 설계 고려사항

### 상관관계의 통계적 한계

**핵심 원칙**: 상관관계 ≠ 인과관계
- 높은 상관계수가 인과 관계를 보장하지 않음
- 제3의 변수(confounding variable)가 영향을 미칠 수 있음
- 통계적 유의성과 실용적 유의성을 구분해야 함

### 모델 신뢰성 확보 방안

**다중 검증 체계**
1. 교차 검증(Cross-validation)을 통한 과적합 방지
2. 지역별 하위 표본을 이용한 일관성 검증
3. 시계열 안정성 테스트

**임계값 설정**
- 최소 상관계수: |r| ≥ 0.3 (중간 강도 이상만 반영)
- 통계적 유의수준: p < 0.05
- 표본 크기: n ≥ 25 (서울시 자치구 수)

### 지속적 개선 체계

**모델 업데이트 주기**
- 분기별 상관계수 재계산
- 연간 가중치 체계 전면 재검토
- 사용자 피드백 기반 실시간 조정

## 20. 실행 계획과 기술적 준비사항

### 즉시 실행해야 할 과제

**1단계: 분석용 데이터셋 구축**
- 서울시 25개 자치구에 대한 모든 변수(인구수, 총범죄 건수, 수집 가능한 모든 환경 데이터)를 하나의 테이블(CSV 또는 DB)로 정리하는 작업이 가장 시급한 과제이다.
- 이 데이터셋이 완성되면, 2단계 상관관계 분석을 진행하여 가중치의 근거를 마련할 수 있다.

### 기술적 구현 준비

**Apache Commons Math 활용**
- Apache Commons Math 라이브러리의 PearsonsCorrelation 클래스 활용 준비
- 안전성 점수 시스템 설계 - Apache Commons Math 기반 구현.md 문서에서 언급된 통계적 접근을 위한 기술적 준비가 이미 고려되고 있어 매우 좋은 방향성이다.

### 데이터 기반 아키텍처의 의의

이 명확한 근거를 바탕으로, 자신감을 가지고 Proxy 모델의 기술 검증(PoC)을 계속 진행할 수 있다. 이 방법론은 주관성을 배제하고 시스템의 논리적 근거를 데이터 자체에서 찾으려는 매우 성숙한 방식이다.

---

## 참고문헌

1. CPTED 발전방향 정책보고서 - 한국셉테드학회
   - URL: https://crimeprevention.joins.com/files/%EB%A7%81%ED%81%AC%EC%9E%90%EB%A3%8C1-%EC%85%89%ED%85%8C%EB%93%9C%20%EB%B0%9C%EC%A0%84%EB%B0%A9%ED%96%A5%20%EC%A0%95%EC%B1%85%EB%B3%B4%EA%B3%A0%EC%84%9C.pdf

2. 환경설계를 통한 범죄예방 방안 - 경찰청
   - URL: https://crimeprevention.joins.com/files/%EB%A7%81%ED%81%AC%EC%9E%90%EB%A3%8C2-%ED%99%98%EA%B2%BD%EC%84%A4%EA%B3%84%EB%A5%BC%20%ED%86%B5%ED%95%9C%20%EB%B2%94%EC%A3%84%EC%98%88%EB%B0%A9%20%EB%B0%A9%EC%95%88(%EA%B2%BD%EC%B0%B0%EC%B2%AD).pdf