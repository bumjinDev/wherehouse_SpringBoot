# ë¶€ë™ì‚° ì¶”ì²œ ì‹œìŠ¤í…œ - ì•ˆì „ì„± ì ìˆ˜ ë°ì´í„° ì—°ë™ ëª…ì„¸ì„œ

**í”„ë¡œì íŠ¸ëª…:** Phase 2 ì¶”ì²œ ì—”ì§„ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì„¤ê³„ - ì•ˆì „ì„± ì ìˆ˜ ë°ì´í„° ì—°ë™ ë¶€ë¬¸  
**ë²„ì „:** 2.3  
**ì‘ì„±ì¼:** 2025.08.21  
**ê¸°ë°˜ ë¬¸ì„œ:** í”„ë¡œì íŠ¸ ê°œì„  ê¸°íšì„œ 3.1í•­ëª© (ì‚¬ìš©ì ì…ë ¥ ë°ì´í„° ì²˜ë¦¬ ì„¤ê³„)  

---

## ëª©ì°¨

1. [ë°ì´í„° ì—°ë™ ì „ëµ ê°œìš”](#1-ë°ì´í„°-ì—°ë™-ì „ëµ-ê°œìš”)
2. [ì•ˆì „ì„± ì ìˆ˜ ë°ì´í„° ì†ŒìŠ¤](#2-ì•ˆì „ì„±-ì ìˆ˜-ë°ì´í„°-ì†ŒìŠ¤)
3. [API ì—°ë™ ê¸°ìˆ  ëª…ì„¸](#3-api-ì—°ë™-ê¸°ìˆ -ëª…ì„¸)

---

## 1. ë°ì´í„° ì—°ë™ ì „ëµ ê°œìš”

### 1.1 í˜„ì¬ ìƒí™© ë¶„ì„

**í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ìš”êµ¬ì‚¬í•­**: ì „ì›”ì„¸ ë§¤ë¬¼ì˜ **ì•ˆì „ì„± ì ìˆ˜** ê³„ì‚°ì„ ìœ„í•œ 4ê°œ ì˜ì—­ ë°ì´í„° í™•ë³´

```
ğŸ“Š ì•ˆì „ì„± ì ìˆ˜ êµ¬ì„± ìš”ì†Œ (100ì  ë§Œì )
â”œâ”€â”€ ë²”ì£„ìœ¨ ë°ì´í„°: 40% (í•œêµ­í˜•ì‚¬ë²•ë¬´ì •ì±…ì—°êµ¬ì›)
â”œâ”€â”€ êµí†µì•ˆì „ ë°ì´í„°: 25% (TAAS êµí†µì‚¬ê³ ë¶„ì„ì‹œìŠ¤í…œ)  
â”œâ”€â”€ CCTV ë°€ë„ ë°ì´í„°: 15% (í–‰ì•ˆë¶€ ì „êµ­CCTV + êµ­í† ë¶€ êµí†µCCTV)
â””â”€â”€ ê³µê³µì‹œì„¤ ì ‘ê·¼ì„± ë°ì´í„°: 20% (ì†Œë°©ì„œ, ë³‘ì›, í•™êµ)

ğŸ¯ ìµœì¢… ì‚°ì¶œë¬¼: ì§€ì—­ë³„ ì•ˆì „ì„± ì ìˆ˜ (0-100ì )
â””â”€â”€ ì „ì›”ì„¸ ì¶”ì²œ ì‹œ ì•ˆì „ìš°ì„  ì˜µì…˜ì— í™œìš©
```

### 1.2 ë°ì´í„° ì—°ë™ ì›ì¹™

| ì›ì¹™ | ë‚´ìš© | êµ¬í˜„ ë°©ë²• |
|------|------|-----------|
| **ê³µê³µë°ì´í„° ìš°ì„ ** | ì‹ ë¢°ì„± ìˆëŠ” ê³µì‹ í†µê³„ í™œìš© | ê³µê³µë°ì´í„°í¬í„¸ ì¤‘ì‹¬ |
| **ë°°ì¹˜ ì²˜ë¦¬ ë°©ì‹** | ì •ì  ë°ì´í„° íŠ¹ì„± ê³ ë ¤ | ì£¼ê¸°ì  ì—…ë°ì´íŠ¸ (ì›”/ë¶„ê¸°) |
| **ì§€ì—­ì½”ë“œ ê¸°ì¤€** | ì‹œêµ°êµ¬ ë‹¨ìœ„ ì•ˆì „ì„± ì‚°ì¶œ | ë²•ì •ë™ì½”ë“œ ë§¤í•‘ |

---

## 2. ì•ˆì „ì„± ì ìˆ˜ ë°ì´í„° ì†ŒìŠ¤

### í•œêµ­í˜•ì‚¬ë²•ë¬´ì •ì±…ì—°êµ¬ì› ë²”ì£„í†µê³„ API (40% ê°€ì¤‘ì¹˜)

* **ê³µê³µë°ì´í„°í¬í„¸**: https://www.data.go.kr/data/15015477/openapi.do
* **ë²”ì£„í†µê³„ ì „ìš© í¬í„¸**: https://www.crimestats.or.kr/portal/openapi/openApiIntroPage.do
* **API ì¢…ë¥˜**: 
  - ë²”ì£„í†µê³„ í†µí•© DB ì •ë³´ (`/getCrimeStatsInfo`)
* **ì„¤ëª…**: í•œêµ­í˜•ì‚¬ë²•ë¬´ì •ì±…ì—°êµ¬ì›ì´ ìš´ì˜í•˜ëŠ” êµ­ë‚´ ìœ ì¼ì˜ ë²”ì£„í†µê³„í¬í„¸ Open APIì…ë‹ˆë‹¤. ì§€ì—­ë³„ ë²”ì£„ í†µê³„ë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### A. ì œê³µ ë°ì´í„° í•­ëª© ë° í™œìš© ë°©ì•ˆ

**ğŸ“Š í•µì‹¬ ì•ˆì „ì„± ê³„ì‚° ë°ì´í„°**
| í•­ëª© | API í•„ë“œëª… | í™œìš© ìš©ë„ | ê°€ì¤‘ì¹˜ |
|------|-----------|----------|--------|
| **ì§€ì—­ì½”ë“œ** | areaCode | ì§€ì—­ ë§¤í•‘ | - |
| **ì§€ì—­ëª…** | areaName | ì§€ì—­ ì‹ë³„ | - |
| **ì‚´ì¸ë°œìƒ** | murderCases | ê°•ë ¥ë²”ì£„ ì ìˆ˜ | 50ì  |
| **ê°•ë„ë°œìƒ** | robberyCases | ê°•ë ¥ë²”ì£„ ì ìˆ˜ | 30ì  |
| **ì„±ë²”ì£„ë°œìƒ** | sexualCrimeCases | ê°•ë ¥ë²”ì£„ ì ìˆ˜ | 35ì  |
| **ì ˆë„ë°œìƒ** | theftCases | ì¼ë°˜ë²”ì£„ ì ìˆ˜ | 10ì  |
| **í­ë ¥ë°œìƒ** | violenceCases | ì¼ë°˜ë²”ì£„ ì ìˆ˜ | 20ì  |
| **ì¸êµ¬ìˆ˜** | population | ë²”ì£„ìœ¨ ì •ê·œí™” | - |

### TAAS êµí†µì‚¬ê³ ë¶„ì„ì‹œìŠ¤í…œ API (25% ê°€ì¤‘ì¹˜)

* **TAAS ê³µì‹ í™ˆí˜ì´ì§€**: https://taas.koroad.or.kr/web/shp/adi/initOpenApi.do
* **ê³µê³µë°ì´í„°í¬í„¸**: https://www.data.go.kr/data/15059126/openapi.do
* **API ì¢…ë¥˜**:
  - ì‚¬ë§êµí†µì‚¬ê³  ì •ë³´ (`/getRestTrafficAccidentDeath`)
* **ì„¤ëª…**: í•œêµ­ë„ë¡œêµí†µê³µë‹¨ì—ì„œ ì œê³µí•˜ëŠ” êµí†µì‚¬ê³  ë¶„ì„ ì „ìš© Open APIì…ë‹ˆë‹¤. ì§€ì—­ë³„ êµí†µì‚¬ê³  í†µê³„ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ì¡°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### A. ì œê³µ ë°ì´í„° í•­ëª©
| í•­ëª© | API í•„ë“œëª… | í™œìš© ìš©ë„ | ê°€ì¤‘ì¹˜ |
|------|-----------|----------|--------|
| **ì‚¬ê³ ì¼ì‹œ** | accidentDateTime | ì‚¬ê³  ë°œìƒ ì‹œì  | - |
| **ì‚¬ê³ ìœ„ì¹˜ìœ„ë„** | latitude | GPS ì¢Œí‘œ | - |
| **ì‚¬ê³ ìœ„ì¹˜ê²½ë„** | longitude | GPS ì¢Œí‘œ | - |
| **ì‚¬ê³ ìœ í˜•** | accidentType | ì‚¬ê³  ì‹¬ê°ë„ ë¶„ë¥˜ | 60% |
| **ì‚¬ë§ììˆ˜** | deathCount | ì¹˜ëª…ë„ ê³„ì‚° | 25% |
| **ë¶€ìƒììˆ˜** | injuryCount | ì‚¬ê³  ì˜í–¥ë„ | 10% |
| **ê°€í•´ì°¨ëŸ‰** | vehicleType | ì°¨ëŸ‰ë³„ ìœ„í—˜ë„ | 5% |

### ì „êµ­CCTVí‘œì¤€ë°ì´í„° + êµí†µCCTV API (15% ê°€ì¤‘ì¹˜)

* **í–‰ì•ˆë¶€ ì „êµ­CCTVí‘œì¤€ë°ì´í„°**: https://www.data.go.kr/data/15013094/standard.do
* **êµ­í† êµí†µë¶€ êµí†µCCTV API**: https://www.data.go.kr/data/3068943/openapi.do
* **ì œê³µ í˜•íƒœ**: 
  - ì „êµ­CCTV: Excel íŒŒì¼ ë‹¤ìš´ë¡œë“œ (ì›” 1íšŒ ì—…ë°ì´íŠ¸)
  - êµí†µCCTV: REST API ì‹¤ì‹œê°„ ì¡°íšŒ
* **ì„¤ëª…**: í–‰ì•ˆë¶€ì—ì„œ ì „êµ­ ìì¹˜ë‹¨ì²´ CCTV ì •ë³´ë¥¼ í†µí•© ì œê³µí•˜ê³ , êµ­í† êµí†µë¶€ì—ì„œ êµí†µ ì „ìš© CCTV APIë¥¼ ë³„ë„ ì œê³µí•©ë‹ˆë‹¤.

#### A. ì œê³µ ë°ì´í„° í•­ëª©
| í•­ëª© | íŒŒì¼/API í•„ë“œëª… | í™œìš© ìš©ë„ |
|------|---------------|----------|
| **ì„¤ì¹˜ìœ„ì¹˜ìœ„ë„** | latitude / LAT | GPS ì¢Œí‘œ |
| **ì„¤ì¹˜ìœ„ì¹˜ê²½ë„** | longitude / LNG | GPS ì¢Œí‘œ |
| **ì„¤ì¹˜ëª©ì ** | purpose / CCTV_PURPS | ìš©ë„ë³„ ê°€ì¤‘ì¹˜ ì ìš© |
| **ê´€ë¦¬ê¸°ê´€ëª…** | manageOrg / MANAGE_ORG | ì‹ ë¢°ë„ í‰ê°€ |
| **ì¹´ë©”ë¼ëŒ€ìˆ˜** | cameraCount / CAMERA_CNT | ë°€ë„ ê³„ì‚° |
| **ì†Œì¬ì§€ë„ë¡œëª…ì£¼ì†Œ** | roadAddress / ROAD_ADDR | ìœ„ì¹˜ í™•ì¸ |

### ê³µê³µì‹œì„¤ ìœ„ì¹˜ì •ë³´ ë°ì´í„° (20% ê°€ì¤‘ì¹˜)

* **ê³µê³µë°ì´í„°í¬í„¸**: https://www.data.go.kr
* **ê²€ìƒ‰ í‚¤ì›Œë“œ**: 'ì „êµ­ ì†Œë°©ì„œ í˜„í™©', 'ì „êµ­ ë³‘ì› í˜„í™©', 'ì „êµ­ í•™êµ í˜„í™©'
* **ì œê³µ í˜•íƒœ**: ê° ê¸°ê´€ë³„ ê°œë³„ íŒŒì¼ ë˜ëŠ” API
* **ì„¤ëª…**: âš ï¸ **ì‹¤ì œ API ëª…ì„¸ ë¯¸í™•ì¸ ìƒíƒœ - ì•„ë˜ëŠ” ì˜ˆìƒ êµ¬ì¡°ì…ë‹ˆë‹¤**

#### A. ì˜ˆìƒ ê³µê³µì‹œì„¤ ë°ì´í„° êµ¬ì¡°
| ì‹œì„¤ ìœ í˜• | ê°€ì¤‘ì¹˜ | ìµœì ê±°ë¦¬ | ì˜ˆìƒ í•„ë“œëª… |
|----------|--------|----------|------------|
| **ì†Œë°©ì„œ** | 40% | 1km ì´ë‚´ | stationName, latitude, longitude |
| **ë³‘ì›** | 40% | 500m ì´ë‚´ | hospitalName, latitude, longitude |
| **í•™êµ** | 20% | 300m ì´ë‚´ | schoolName, latitude, longitude |

---

## 3. API ì—°ë™ ê¸°ìˆ  ëª…ì„¸

### í•œêµ­í˜•ì‚¬ë²•ë¬´ì •ì±…ì—°êµ¬ì› ë²”ì£„í†µê³„ API ì—°ë™ ëª…ì„¸

#### A. API ê¸°ë³¸ ì„¤ì • ë° í™˜ê²½ êµ¬ì„±

**í•„ìˆ˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë° ì˜ì¡´ì„±:**
```xml
<!-- pom.xml (Maven ê¸°ì¤€) -->
<dependencies>
    <!-- Spring Boot Web (HTTP í†µì‹ ìš©) -->
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-webflux</artifactId>
    </dependency>
    
    <!-- Spring Boot Batch (ë°°ì¹˜ ì²˜ë¦¬ìš©) -->
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-batch</artifactId>
    </dependency>
    
    <!-- Excel íŒŒì‹±ìš© -->
    <dependency>
        <groupId>org.apache.poi</groupId>
        <artifactId>poi-ooxml</artifactId>
    </dependency>
</dependencies>
```

**ì£¼ìš” Import ë¼ì´ë¸ŒëŸ¬ë¦¬:**
```java
// Spring ê´€ë ¨
import org.springframework.beans.factory.annotation.Value;
import org.springframework.stereotype.Component;
import org.springframework.scheduling.annotation.Scheduled;

// HTTP í†µì‹  ê´€ë ¨
import org.springframework.web.reactive.function.client.WebClient;
import org.springframework.web.client.RestTemplate;

// JSON íŒŒì‹± ê´€ë ¨
import com.fasterxml.jackson.annotation.JsonProperty;
import com.fasterxml.jackson.annotation.JsonIgnoreProperties;

// Excel íŒŒì‹± ê´€ë ¨ 
import org.apache.poi.ss.usermodel.*;

// ì‹œê°„ ì²˜ë¦¬ (JDK 8+)
import java.time.LocalDate;

// ì»¬ë ‰ì…˜ (JDK ê¸°ë³¸ ì œê³µ)
import java.util.*;
import java.util.stream.Collectors;
```

```yaml
# application.yml ì„¤ì •
crime:
  api:
    service-key: ${CRIME_API_SERVICE_KEY:your-api-key}
    base-url: https://www.crimestats.or.kr/portal/openapi

taas:
  api:
    service-key: ${TAAS_API_SERVICE_KEY:your-api-key}
    base-url: http://apis.data.go.kr/B552061/AccidentDeath

traffic:
  cctv:
    service-key: ${TRAFFIC_CCTV_SERVICE_KEY:your-api-key}
    base-url: http://apis.data.go.kr/3068943/openapi/TrafficCCTV
```

#### B. ë²”ì£„í†µê³„ API í˜¸ì¶œ êµ¬í˜„

```java
/**
 * í•œêµ­í˜•ì‚¬ë²•ë¬´ì •ì±…ì—°êµ¬ì› ë²”ì£„í†µê³„ API í˜¸ì¶œ
 */
@Component
public class CrimeStatsApiClient {
    
    private final WebClient webClient;
    
    @Value("${crime.api.service-key}")
    private String serviceKey;
    
    public CrimeStatsApiClient() {
        this.webClient = WebClient.builder()
                .baseUrl("https://www.crimestats.or.kr/portal/openapi")
                .build();
    }
    
    /**
     * ì§€ì—­ë³„ ë²”ì£„í†µê³„ ì¡°íšŒ
     */
    public CrimeStatsResponse getCrimeStatistics(String areaCode, String year) {
        return webClient.get()
                .uri(uriBuilder -> uriBuilder
                        .path("/getCrimeStatsInfo")
                        .queryParam("serviceKey", serviceKey)
                        .queryParam("areaCode", areaCode)
                        .queryParam("year", year)
                        .queryParam("dataType", "JSON")
                        .build())
                .retrieve()
                .bodyToMono(CrimeStatsResponse.class)
                .block();
    }
}

/**
 * ë²”ì£„í†µê³„ API ì‘ë‹µ ëª¨ë¸
 */
@Data
@JsonIgnoreProperties(ignoreUnknown = true)
public class CrimeStatsResponse {
    @JsonProperty("areaCode")
    private String areaCode;
    
    @JsonProperty("areaName") 
    private String areaName;
    
    @JsonProperty("murderCases")
    private int murderCases;
    
    @JsonProperty("robberyCases")
    private int robberyCases;
    
    @JsonProperty("sexualCrimeCases")
    private int sexualCrimeCases;
    
    @JsonProperty("theftCases")
    private int theftCases;
    
    @JsonProperty("violenceCases")
    private int violenceCases;
    
    @JsonProperty("population")
    private int population;
}
```

#### C. êµí†µì‚¬ê³  API í˜¸ì¶œ êµ¬í˜„

```java
/**
 * TAAS êµí†µì‚¬ê³ ë¶„ì„ì‹œìŠ¤í…œ API í˜¸ì¶œ
 */
@Component
public class TaasApiClient {
    
    private final RestTemplate restTemplate;
    
    @Value("${taas.api.service-key}")
    private String serviceKey;
    
    public TaasApiClient() {
        this.restTemplate = new RestTemplate();
    }
    
    /**
     * ì‚¬ë§êµí†µì‚¬ê³  ì •ë³´ ì¡°íšŒ
     */
    public List<TrafficAccidentResponse> getTrafficAccidents(String areaCode, String year) {
        String url = "http://apis.data.go.kr/B552061/AccidentDeath/getRestTrafficAccidentDeath";
        
        UriComponentsBuilder builder = UriComponentsBuilder.fromHttpUrl(url)
                .queryParam("serviceKey", serviceKey)
                .queryParam("searchYear", year)
                .queryParam("siDo", extractSiDoFromAreaCode(areaCode))
                .queryParam("guGun", extractGuGunFromAreaCode(areaCode))
                .queryParam("type", "json")
                .queryParam("numOfRows", "1000")
                .queryParam("pageNo", "1");
        
        try {
            ResponseEntity<TaasApiResponse> response = restTemplate.getForEntity(
                    builder.toUriString(), TaasApiResponse.class);
            
            if (response.getStatusCode().is2xxSuccessful() && response.getBody() != null) {
                return response.getBody().getItems();
            }
            
            return Collections.emptyList();
            
        } catch (Exception e) {
            log.error("TAAS API í˜¸ì¶œ ì‹¤íŒ¨", e);
            return Collections.emptyList();
        }
    }
}

/**
 * TAAS API ì‘ë‹µ ëª¨ë¸
 */
@Data
@JsonIgnoreProperties(ignoreUnknown = true)
public class TrafficAccidentResponse {
    @JsonProperty("occrrncDt")
    private String accidentDate;
    
    @JsonProperty("dthDnvCnt")
    private int deathCount;
    
    @JsonProperty("injpsn_cnt")
    private int injuryCount;
    
    @JsonProperty("lo_crd")
    private double longitude;
    
    @JsonProperty("la_crd")
    private double latitude;
    
    @JsonProperty("acc_ty_cd")
    private String accidentType;
    
    @JsonProperty("dmgCas_cd")
    private String vehicleType;
}
```

#### D. ë°ì´í„° ì—…ë°ì´íŠ¸ ìŠ¤ì¼€ì¤„ ê´€ë¦¬

```java
/**
 * ì•ˆì „ì„± ë°ì´í„° ì—…ë°ì´íŠ¸ ìŠ¤ì¼€ì¤„ëŸ¬
 */
@Component
@EnableScheduling
public class SafetyDataScheduler {
    
    @Autowired
    private CrimeStatsApiClient crimeStatsApiClient;
    
    @Autowired
    private TaasApiClient taasApiClient;
    
    /**
     * ë²”ì£„ í†µê³„ ë°ì´í„° ì—…ë°ì´íŠ¸ (ì›” 1íšŒ)
     */
    @Scheduled(cron = "0 2 1 * *") // ë§¤ì›” 1ì¼ ìƒˆë²½ 2ì‹œ
    public void updateCrimeStatistics() {
        log.info("ë²”ì£„ í†µê³„ ë°ì´í„° ì—…ë°ì´íŠ¸ ì‹œì‘");
        
        try {
            List<String> areaCodes = getAllAreaCodes();
            String currentYear = String.valueOf(LocalDate.now().getYear());
            
            for (String areaCode : areaCodes) {
                CrimeStatsResponse crimeData = crimeStatsApiClient.getCrimeStatistics(areaCode, currentYear);
                saveCrimeStatistics(areaCode, crimeData);
            }
            
            log.info("ë²”ì£„ í†µê³„ ë°ì´í„° ì—…ë°ì´íŠ¸ ì™„ë£Œ");
            
        } catch (Exception e) {
            log.error("ë²”ì£„ í†µê³„ ë°ì´í„° ì—…ë°ì´íŠ¸ ì‹¤íŒ¨", e);
        }
    }
    
    /**
     * êµí†µì‚¬ê³  ë°ì´í„° ì—…ë°ì´íŠ¸ (ì£¼ 1íšŒ)
     */
    @Scheduled(cron = "0 3 * * 1") // ë§¤ì£¼ ì›”ìš”ì¼ ìƒˆë²½ 3ì‹œ
    public void updateTrafficAccidentData() {
        log.info("êµí†µì‚¬ê³  ë°ì´í„° ì—…ë°ì´íŠ¸ ì‹œì‘");
        
        try {
            List<String> areaCodes = getAllAreaCodes();
            String currentYear = String.valueOf(LocalDate.now().getYear());
            
            for (String areaCode : areaCodes) {
                List<TrafficAccidentResponse> accidents = taasApiClient.getTrafficAccidents(areaCode, currentYear);
                saveTrafficAccidentData(areaCode, accidents);
            }
            
            log.info("êµí†µì‚¬ê³  ë°ì´í„° ì—…ë°ì´íŠ¸ ì™„ë£Œ");
            
        } catch (Exception e) {
            log.error("êµí†µì‚¬ê³  ë°ì´í„° ì—…ë°ì´íŠ¸ ì‹¤íŒ¨", e);
        }
    }
    
    /**
     * ì•ˆì „ì„± ì ìˆ˜ ì¬ê³„ì‚° (ì›” 1íšŒ)
     */
    @Scheduled(cron = "0 4 1 * *") // ë§¤ì›” 1ì¼ ìƒˆë²½ 4ì‹œ
    public void recalculateSafetyScores() {
        log.info("ì•ˆì „ì„± ì ìˆ˜ ì¬ê³„ì‚° ì‹œì‘");
        
        List<String> areaCodes = getAllAreaCodes();
        for (String areaCode : areaCodes) {
            // ê° ì§€ì—­ë³„ë¡œ ì•ˆì „ì„± ì ìˆ˜ ê³„ì‚° ë¡œì§ í˜¸ì¶œ
            updateSafetyScoreForArea(areaCode);
        }
        
        log.info("ì•ˆì „ì„± ì ìˆ˜ ì¬ê³„ì‚° ì™„ë£Œ");
    }
}